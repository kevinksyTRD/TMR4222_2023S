<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Numerical Method in Python | TMR4222 Marine Machinery - Viscous Flow in Pipes</title>
    <meta name="generator" content="VuePress 1.9.8">
    <script type="text/javascript" src="https://polyfill.io/v3/polyfill.js?features=es6"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>
    <meta name="description" content="Documentation for TMR4222 Viscous Flow in Pipe">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/TMR4222_2023S/assets/css/0.styles.4543153c.css" as="style"><link rel="preload" href="/TMR4222_2023S/assets/js/app.4abb8553.js" as="script"><link rel="preload" href="/TMR4222_2023S/assets/js/2.2891b1df.js" as="script"><link rel="preload" href="/TMR4222_2023S/assets/js/4.56bc5be8.js" as="script"><link rel="prefetch" href="/TMR4222_2023S/assets/js/10.2f61165d.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/11.2d18e7c2.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/12.3587cb85.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/13.f4be4253.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/14.25aae0a8.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/15.9724357a.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/16.b87e2b3e.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/17.ce1966c7.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/3.2051a86c.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/5.c3e09589.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/6.ff7d345b.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/7.703bd4b0.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/8.6b2ef9ff.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/9.8906a95d.js">
    <link rel="stylesheet" href="/TMR4222_2023S/assets/css/0.styles.4543153c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TMR4222_2023S/" class="home-link router-link-active"><!----> <span class="site-name">TMR4222 Marine Machinery - Viscous Flow in Pipes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/TMR4222_2023S/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/TMR4222_2023S/python-with-anaconda/" class="sidebar-link">Python with Anaconda</a></li><li><a href="/TMR4222_2023S/numerical-method-python/" aria-current="page" class="active sidebar-link">Numerical method in Python</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TMR4222_2023S/numerical-method-python/#packages" class="sidebar-link">Packages</a></li><li class="sidebar-sub-header"><a href="/TMR4222_2023S/numerical-method-python/#using-numpy" class="sidebar-link">Using Numpy</a></li><li class="sidebar-sub-header"><a href="/TMR4222_2023S/numerical-method-python/#using-functions-and-partial-functions" class="sidebar-link">Using Functions and Partial Functions</a></li><li class="sidebar-sub-header"><a href="/TMR4222_2023S/numerical-method-python/#plotting-results" class="sidebar-link">Plotting results</a></li><li class="sidebar-sub-header"><a href="/TMR4222_2023S/numerical-method-python/#numerical-optimization" class="sidebar-link">Numerical Optimization</a></li><li class="sidebar-sub-header"><a href="/TMR4222_2023S/numerical-method-python/#numerical-integration-solving-ode" class="sidebar-link">Numerical Integration / Solving ODE</a></li><li class="sidebar-sub-header"><a href="/TMR4222_2023S/numerical-method-python/#further-dive-into-the-scientific-calculation-with-python" class="sidebar-link">Further dive into the scientific calculation with python</a></li></ul></li><li><a href="/TMR4222_2023S/pipe-friction/" class="sidebar-link">Pipe Friction</a></li><li><a href="/TMR4222_2023S/pipe-network-analysis/" class="sidebar-link">Pipe Network Analysis</a></li><li><a href="/TMR4222_2023S/pump-performance/" class="sidebar-link">Pump Performance</a></li><li><a href="/TMR4222_2023S/pump-control/" class="sidebar-link">Pump Control</a></li><li><a href="/TMR4222_2023S/positive-displacement-pump/" class="sidebar-link">Positive Displacement Pump</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="numerical-method-in-python"><a href="#numerical-method-in-python" class="header-anchor">#</a> Numerical Method in Python</h1> <p>Most of examples in this lecture is given as a Jupyter notebook. You can also solve your
exercises in the Jupyter notebook. Some of the exams questions will require you to use the same.
This means you will have to be familiar with solving the engineering problems with Python. Python
is becoming a more and more popular both as a general programming language and as an engineering
tool.</p> <h2 id="packages"><a href="#packages" class="header-anchor">#</a> Packages</h2> <p>Apart from the core functions and language syntax which comes when you install Python, you can
easily expand the capability of the language by installing packages usually provided as a open
source software. You can also build your own python packages and share it with others. The most
useful packages for solving general engineering problems are scipy and numpy.</p> <h3 id="installation-of-the-package"><a href="#installation-of-the-package" class="header-anchor">#</a> Installation of the package</h3> <p>Packages can be easily installed by</p> <div class="language-commandline extra-class"><pre class="language-text"><code>pip install [package name, ...]
</code></pre></div><p>So, you can install scipy and numpy packages by</p> <div class="language-commandline extra-class"><pre class="language-text"><code>pip install scipy, numpy
</code></pre></div><p>In some cases, you may have to manage many packages for a specific application. A simple way to
do it is to list the package in a text file (e.g. 'requirements.txt') and simply type</p> <div class="language-commandline extra-class"><pre class="language-text"><code>pip install -r requirements.txt
</code></pre></div><h3 id="virtual-environment"><a href="#virtual-environment" class="header-anchor">#</a> Virtual Environment</h3> <p>Each application may need to have a different set of packages. Furthermore, An applicaiton may
depend on a specific version of a package while other applications depend on another version. To
resolve these conflicts in versions and packages, it is recommended to use a virtual environment
for an application. Virtual environment, when it is activated, provides an isolated python
environment from others.</p> <p>First, you have to install the virtual environment package if you haven't. I will assume that
you can enter 'python' in any directory to run Python.</p> <div class="language-commandline extra-class"><pre class="language-text"><code>pip install virtualenv
</code></pre></div><p>Then you need to be in the directory of
the target directory.</p> <div class="language-commandline extra-class"><pre class="language-text"><code>cd target_directory
</code></pre></div><p>Then, create a virtual environment.</p> <div class="language-commandline extra-class"><pre class="language-text"><code>python -m virtualenv venv
</code></pre></div><p>This will create your virtual environment in 'venv' directory. Next you can activate the virtual
environment. If you are on Windows PC,</p> <div class="language-commandline extra-class"><pre class="language-text"><code>venv\Script\activate
</code></pre></div><p>Otherwise,</p> <div class="language-commandline extra-class"><pre class="language-text"><code>source venv/bin/activate
</code></pre></div><p>NB! Whenever you restarted the terminal, make sure that you activate the virtual environment using
the above command.</p> <h3 id="importing-packages"><a href="#importing-packages" class="header-anchor">#</a> Importing packages</h3> <p>In order to use the packages, we have to import the package in the module or notebook. When I say
module, it refers to a file with extension of '.py' We will first import numpy.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
</code></pre></div><p>You see that I imported numpy with aliased name &quot;np&quot; above. The aliasing may be omitted and you
can use numpy as a full name to use classes, functions, attributes of numpy package. We will try
to use numpy to print the value of $\pi$.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>pi<span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>3.141592653589793
</code></pre></div><p>When you want to import a specific module, classes, functions or attributes from the package, you
can do that using &quot;from&quot;</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> scipy<span class="token punctuation">.</span>integrate <span class="token keyword">import</span> solve_ivp
<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>optimize <span class="token keyword">import</span> minimize_scalar<span class="token punctuation">,</span> root
</code></pre></div><h2 id="using-numpy"><a href="#using-numpy" class="header-anchor">#</a> Using Numpy</h2> <p>We will start exploring how to use numpy array. Numpy is the fundamental package for scientific
computing with Python. I use numpy to handle multi-dimensional arrays mostly.</p> <h3 id="create-a-numpy-array"><a href="#create-a-numpy-array" class="header-anchor">#</a> Create a numpy array</h3> <p>To create a numpy arrays,</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 1d array</span>
np_array_1d_from_list <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># Creating a 1D array from a list</span>
np_array_1d_from_iterator <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># Creating a 1D array from an iterator</span>
np_array_1d_from_random <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment"># Creating a 1D array of 10 random numbers</span>
np_array_1d_from_arange <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># Creating a 1D array from 0 to 1 with step of 1</span>
np_array_1d_from_lin_space <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span>start<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> stop<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> num<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token comment"># Creating a 1D array by linspace</span>
np_array_1d_zeros <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment"># Creating a zero-vector of a length of 10.</span>
np_array_1d_ones <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment"># Creating a one-vector of a length of 10.</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;From a list: </span><span class="token interpolation"><span class="token punctuation">{</span>np_array_1d_from_list<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;From an iterator: </span><span class="token interpolation"><span class="token punctuation">{</span>np_array_1d_from_iterator<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Using a random function: </span><span class="token interpolation"><span class="token punctuation">{</span>np_array_1d_from_random<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Using an arange function: </span><span class="token interpolation"><span class="token punctuation">{</span>np_array_1d_from_arange<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Using a lin space function: </span><span class="token interpolation"><span class="token punctuation">{</span>np_array_1d_from_lin_space<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Using a zeros function: </span><span class="token interpolation"><span class="token punctuation">{</span>np_array_1d_zeros<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Using a ones function: </span><span class="token interpolation"><span class="token punctuation">{</span>np_array_1d_ones<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># 2d array</span>
np_array_2d_from_list <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
np_array_2d_from_random <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
np_array_2d_from_meshgrid <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>
    np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;2D array from a list: \n </span><span class="token interpolation"><span class="token punctuation">{</span>np_array_2d_from_list<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Shape of the 2D array is : </span><span class="token interpolation"><span class="token punctuation">{</span>np_array_2d_from_list<span class="token punctuation">.</span>shape<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;2D array from the random function: \n </span><span class="token interpolation"><span class="token punctuation">{</span>np_array_2d_from_random<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;2D array from the meshgrid function \n </span><span class="token interpolation"><span class="token punctuation">{</span>np_array_2d_from_meshgrid<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>np_array_2d_from_meshgrid<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>From a list: [1 2 3]
From an iterator: [0 1 2 3 4 5 6 7 8 9]
Using a random function: [0.51462656 0.4611812  0.61464877 0.2688413  0.20823497 0.67954175
 0.19178084 0.99300547 0.22526408 0.60033815]
Using an arange function: [0 1 2 3 4 5 6 7 8 9]
Using a lin space function: [  0.  10.  20.  30.  40.  50.  60.  70.  80.  90. 100.]
Using a zeros function: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
Using a ones function: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]


2D array from a list: 
 [[1 2 3]
 [4 5 6]]
Shape of the 2D array is : (2, 3)
2D array from the random function: 
 [[0.04771196 0.46575961 0.28640024 0.56194939 0.14192946]
 [0.76916407 0.45188821 0.52630999 0.33041153 0.80564117]]
2D array from the meshgrid function 
 [array([[0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. ],
       [0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. ],
       [0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. ],
       [0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. ],
       [0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. ],
       [0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. ],
       [0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. ],
       [0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. ],
       [0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. ],
       [0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. ],
       [0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. ]]), array([[1. , 1. , 1. , 1. , 1. , 1. , 1. , 1. , 1. , 1. , 1. ],
       [1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1],
       [1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2],
       [1.3, 1.3, 1.3, 1.3, 1.3, 1.3, 1.3, 1.3, 1.3, 1.3, 1.3],
       [1.4, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4],
       [1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5],
       [1.6, 1.6, 1.6, 1.6, 1.6, 1.6, 1.6, 1.6, 1.6, 1.6, 1.6],
       [1.7, 1.7, 1.7, 1.7, 1.7, 1.7, 1.7, 1.7, 1.7, 1.7, 1.7],
       [1.8, 1.8, 1.8, 1.8, 1.8, 1.8, 1.8, 1.8, 1.8, 1.8, 1.8],
       [1.9, 1.9, 1.9, 1.9, 1.9, 1.9, 1.9, 1.9, 1.9, 1.9, 1.9],
       [2. , 2. , 2. , 2. , 2. , 2. , 2. , 2. , 2. , 2. , 2. ]])]
&lt;class 'list'&gt;
</code></pre></div><p>Check out <a href="https://numpy.org/doc/stable/reference/routines.array-creation.html" target="_blank" rel="noopener noreferrer">this link<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for
various methods to create arrays.</p> <h4 id="exercise"><a href="#exercise" class="header-anchor">#</a> Exercise</h4> <p>We are given with a function of temperature in <sup>o</sup>C in $x$ that is position in m,
$$T(x) = 400 - 50x + 10x^2 + 0.4x^3$$
Calculate the temperatures from x=0 to x=1 with an interval of 0.1 and plot it.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># Exercise</span>
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Union
<span class="token keyword">from</span> plotly<span class="token punctuation">.</span>subplots <span class="token keyword">import</span> make_subplots

<span class="token comment"># Define the function to get temperature</span>
<span class="token keyword">def</span> <span class="token function">get_temperature</span><span class="token punctuation">(</span>x_position<span class="token punctuation">:</span> Union<span class="token punctuation">[</span><span class="token builtin">float</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Union<span class="token punctuation">[</span><span class="token builtin">float</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token number">400</span> <span class="token operator">-</span> <span class="token number">50</span><span class="token operator">*</span>x_position <span class="token operator">+</span> <span class="token number">10</span><span class="token operator">*</span>x_position<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">0.4</span><span class="token operator">*</span>x_position<span class="token operator">**</span><span class="token number">3</span>

<span class="token comment"># Create a 1D array of x position</span>
x_position_array <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token comment"># Your code here</span>

<span class="token comment"># Calculate the temperature</span>
temperature_array <span class="token operator">=</span> get_temperature<span class="token punctuation">(</span>x_position_array<span class="token punctuation">)</span>

<span class="token comment"># Plot</span>

fig <span class="token operator">=</span> make_subplots<span class="token punctuation">(</span>column_widths<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">800</span><span class="token punctuation">]</span><span class="token punctuation">,</span> row_heights<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">600</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x_title<span class="token operator">=</span><span class="token string">&quot;Position [m]&quot;</span><span class="token punctuation">,</span> y_title<span class="token operator">=</span><span class="token string">&quot;Temperature [degC]&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>x_position_array<span class="token punctuation">,</span> y<span class="token operator">=</span>temperature_array<span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span>renderer<span class="token operator">=</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/TMR4222_2023S/assets/img/00_Numerical_Method_in_Python_15_0.099a89f8.svg" alt="svg"></p> <h3 id="accessing-the-array"><a href="#accessing-the-array" class="header-anchor">#</a> Accessing the array</h3> <p>You can array a value in the array with the index. The first element in the array has index, 0.
You can access the last element with index, -1, ans the second last with -2, and so on.</p> <h4 id="exercise-2"><a href="#exercise-2" class="header-anchor">#</a> Exercise</h4> <p>From the exercise above, what is the temperature at $x$=0 and $x=1$.</p> <div class="language-python extra-class"><pre class="language-python"><code>temperature_x_0 <span class="token operator">=</span> temperature_array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
temperature_x_1 <span class="token operator">=</span> temperature_array<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Temperature at x=0: </span><span class="token interpolation"><span class="token punctuation">{</span>temperature_x_0<span class="token punctuation">}</span></span><span class="token string"> degC&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Temperature at x=1: </span><span class="token interpolation"><span class="token punctuation">{</span>temperature_x_1<span class="token punctuation">}</span></span><span class="token string"> degC&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>Temperature at x=0: 400.0 degC
Temperature at x=1: 360.4 degC
</code></pre></div><p>We can also access the array in range. For example, to access the first 3 elements</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span>x_position_array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>[0.  0.1 0.2]
</code></pre></div><p>We can also access the array toward the end. For example, to access the last 10 elemenents</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span>x_position_array<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>[0.8 0.9 1. ]
</code></pre></div><p>If you want to access something in between, from index 3 to 6, use the following.</p> <div class="language-python extra-class"><pre class="language-python"><code>x_position_array<span class="token punctuation">[</span>x<span class="token punctuation">:</span>y<span class="token punctuation">]</span>
</code></pre></div><p>Note that the <code>x_position_array[6]</code> is not inclusive here. You can also access the elemets by
conditions. To access the elements which has value that is greater than 0.5,</p> <div class="language-python extra-class"><pre class="language-python"><code>index_array <span class="token operator">=</span> x_position_array <span class="token operator">&gt;</span> <span class="token number">0.5</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>index_array<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x_position_array<span class="token punctuation">[</span>index_array<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>[False False False False False False  True  True  True  True  True]
[0.6 0.7 0.8 0.9 1. ]
</code></pre></div><h4 id="exercise-3"><a href="#exercise-3" class="header-anchor">#</a> Exercise</h4> <p>Plot the temperature graphs for 0.4&lt;=$x$&lt;=0.7. Use the output from the exercise above.
(Hint. Use <code>np.bitwise_and(x1, x2)</code> to get AND operation of two array of boolean values.)</p> <div class="language-python extra-class"><pre class="language-python"><code>index_array <span class="token operator">=</span> np<span class="token punctuation">.</span>bitwise_and<span class="token punctuation">(</span>x_position_array <span class="token operator">&gt;=</span> <span class="token number">0.4</span><span class="token punctuation">,</span> x_position_array <span class="token operator">&lt;=</span> <span class="token number">0.7</span><span class="token punctuation">)</span>
x_position_array_to_plot <span class="token operator">=</span> x_position_array<span class="token punctuation">[</span>index_array<span class="token punctuation">]</span>
temperature_array_to_plot <span class="token operator">=</span> temperature_array<span class="token punctuation">[</span>index_array<span class="token punctuation">]</span>

fig <span class="token operator">=</span> make_subplots<span class="token punctuation">(</span>column_widths<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">800</span><span class="token punctuation">]</span><span class="token punctuation">,</span> row_heights<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">600</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x_title<span class="token operator">=</span><span class="token string">&quot;Position [m]&quot;</span><span class="token punctuation">,</span> y_title<span class="token operator">=</span><span class="token string">&quot;Temperature [degC]&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>x_position_array_to_plot<span class="token punctuation">,</span> y<span class="token operator">=</span>temperature_array_to_plot<span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span>renderer<span class="token operator">=</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/TMR4222_2023S/assets/img/00_Numerical_Method_in_Python_26_0.6c55f721.svg" alt="svg"></p> <h3 id="array-operation"><a href="#array-operation" class="header-anchor">#</a> Array operation</h3> <p>You can apply most of the arithmetic operations to the array.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Multiplying an array with a scalar: </span><span class="token interpolation"><span class="token punctuation">{</span>x_position_array <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Adding an array with a scalar: </span><span class="token interpolation"><span class="token punctuation">{</span>x_position_array <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Squaring an array with a scalar: </span><span class="token interpolation"><span class="token punctuation">{</span>x_position_array<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>Multiplying an array with a scalar: [ 0.  1.  2.  3.  4.  5.  6.  7.  8.  9. 10.]
Adding an array with a scalar: [1.  1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9 2. ]
Squaring an array with a scalar: [0.   0.01 0.04 0.09 0.16 0.25 0.36 0.49 0.64 0.81 1.  ]
</code></pre></div><p>The same applies to functions.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Sine of an array: </span><span class="token interpolation"><span class="token punctuation">{</span>np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>x_position_array<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Exponential value of an array: </span><span class="token interpolation"><span class="token punctuation">{</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>x_position_array<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>Sine of an array: [0.         0.09983342 0.19866933 0.29552021 0.38941834 0.47942554
 0.56464247 0.64421769 0.71735609 0.78332691 0.84147098]
Exponential value of an array: [1.         1.10517092 1.22140276 1.34985881 1.4918247  1.64872127
 1.8221188  2.01375271 2.22554093 2.45960311 2.71828183]
</code></pre></div><p>If you do the arithmetic for two arrays, the arithmetic happens element wise also.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Adding two arrays: </span><span class="token interpolation"><span class="token punctuation">{</span>x_position_array <span class="token operator">+</span> x_position_array<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Multiplying two arrays: </span><span class="token interpolation"><span class="token punctuation">{</span>x_position_array <span class="token operator">*</span> x_position_array<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>Adding two arrays: [0.  0.2 0.4 0.6 0.8 1.  1.2 1.4 1.6 1.8 2. ]
Multiplying two arrays: [0.   0.01 0.04 0.09 0.16 0.25 0.36 0.49 0.64 0.81 1.  ]
</code></pre></div><h2 id="using-functions-and-partial-functions"><a href="#using-functions-and-partial-functions" class="header-anchor">#</a> Using Functions and Partial Functions</h2> <p>Function allows you to use the algorithm or calculations repetitively without writing it
over and over. Whenever you realize that a piece of code is used more than once, it is a good
idea to implement it as a function. Sometimes you want to change the algorithm or correct a bug.
Then you only have to correct once in the function.</p> <h3 id="defining-a-function"><a href="#defining-a-function" class="header-anchor">#</a> Defining a function</h3> <p>Here's a basic syntax for defining a function</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">function_name</span><span class="token punctuation">(</span>arg1<span class="token punctuation">,</span> arg2<span class="token punctuation">,</span> arg3<span class="token punctuation">)</span><span class="token punctuation">:</span>
    something <span class="token operator">=</span> arg1 <span class="token operator">+</span> arg2 <span class="token operator">+</span> arg3
    <span class="token keyword">return</span> something
</code></pre></div><p>You can define a function in any place of the module. Usually you define a function before its
usage. You can define a function within a function. In that case, the function is only usable
within the wrapping function.</p> <p>A function must have a name. In modern programming, we are not so eager to use abbreviation. We
would rather use a name that is understood to anyone. So don't squeeze your head to find a short
function name with a lot of abbreviations but just use more daily words.</p> <p>A function takes arguments. You can make a function without any argument also. Argument can be
anything, really. It can be a numeric value, string, or even a function. You can pass an instance
of a class or class type.</p> <p>A function always returns a value. If you don't specify anything, the function returns None.</p> <h4 id="exercise-4"><a href="#exercise-4" class="header-anchor">#</a> Exercise</h4> <p>Create a function for the temperature change over time.
$$T(t) = T_0 + T_\mathrm{rise}\left(1 - e^{-\frac{t}{tau}}\right)$$
Plot a graph for $0 \leq t \leq 20$ given $\tau=5$, $T_0$ = 500 and  $T_\mathrm{rise}$ = 200.</p> <div class="language-python extra-class"><pre class="language-python"><code>Numeric <span class="token operator">=</span> Union<span class="token punctuation">[</span><span class="token builtin">float</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">get_temperature</span><span class="token punctuation">(</span>
        time<span class="token punctuation">:</span> Numeric<span class="token punctuation">,</span>
        initial_temperature<span class="token punctuation">:</span> Numeric<span class="token punctuation">,</span>
        rise_temperature<span class="token punctuation">:</span> Numeric<span class="token punctuation">,</span>
        tau<span class="token punctuation">:</span> Numeric
<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Numeric<span class="token punctuation">:</span>
    <span class="token keyword">return</span> initial_temperature <span class="token operator">+</span> rise_temperature <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">/</span> tau <span class="token operator">*</span>  time<span class="token punctuation">)</span><span class="token punctuation">)</span>

time_array <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">201</span><span class="token punctuation">)</span>
temperature_array <span class="token operator">=</span> get_temperature<span class="token punctuation">(</span>
    time<span class="token operator">=</span>time_array<span class="token punctuation">,</span>
    initial_temperature<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>
    rise_temperature<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span>
    tau<span class="token operator">=</span><span class="token number">5</span>
<span class="token punctuation">)</span>

fig <span class="token operator">=</span> make_subplots<span class="token punctuation">(</span>column_widths<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">800</span><span class="token punctuation">]</span><span class="token punctuation">,</span> row_heights<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">600</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x_title<span class="token operator">=</span><span class="token string">&quot;Position [m]&quot;</span><span class="token punctuation">,</span> y_title<span class="token operator">=</span><span class="token string">&quot;Temperature [degC]&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>time_array<span class="token punctuation">,</span> y<span class="token operator">=</span>temperature_array<span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span>renderer<span class="token operator">=</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/TMR4222_2023S/assets/img/00_Numerical_Method_in_Python_36_0.6b7f1635.svg" alt="svg"></p> <h3 id="typing-hint"><a href="#typing-hint" class="header-anchor">#</a> Typing hint</h3> <p>It is a good idea to provide the hint for the types that you expect for the argument and return
values when you implement a function. It makes the use of function easier and people don't have
to do trial and error to see which data type the function can accept. The following syntax is
used to give the typing hint.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">function</span><span class="token punctuation">(</span>arg1<span class="token punctuation">:</span> type1<span class="token punctuation">,</span> arg2<span class="token punctuation">:</span> type2<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> return_type<span class="token punctuation">:</span>
    <span class="token keyword">return</span> value
</code></pre></div><p>A type can be a built-in types such as <code>int</code>, <code>float</code>, <code>list</code>, etc, or it can be a class or
function.</p> <p>If the value can take more than one type, then you can use <code>Union</code> that you can import from
typing package.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> typing impot Union

<span class="token keyword">def</span> <span class="token function">function</span><span class="token punctuation">(</span>arg1<span class="token punctuation">:</span> Union<span class="token punctuation">[</span>type1<span class="token punctuation">,</span> type2<span class="token punctuation">]</span><span class="token punctuation">,</span> arg2<span class="token punctuation">:</span> Union<span class="token punctuation">[</span>type1<span class="token punctuation">,</span> type2<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> return_type<span class="token punctuation">:</span>
    <span class="token keyword">return</span> value
</code></pre></div><h3 id="partial-function"><a href="#partial-function" class="header-anchor">#</a> Partial function</h3> <p>Partial function is used when you need to freeze some arguments when a function is used. It is like
defining a new function that calls the function you wan to use. For example,</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">add_two_values</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x<span class="token punctuation">,</span> y

<span class="token keyword">def</span> <span class="token function">add_two_to_a_value</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> add_two_values<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><p>Instead of defining a new function,</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> functools <span class="token keyword">import</span> partial

add_two_to_a_value <span class="token operator">=</span> partial<span class="token punctuation">(</span>add_two_values<span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><p>This improves the readability of the function. This can be effectively used in other functions
that takes a function as an argument. We will see the examples in the numerical optimization
section or numerical integration section.</p> <h2 id="plotting-results"><a href="#plotting-results" class="header-anchor">#</a> Plotting results</h2> <p>matplotlib is a basic package everyone uses when they want to plot numerical values in Python.
There are other high-level packages that provides templates for more advanced plots such as
Plotly or Seaborn.</p> <h4 id="exercise-5"><a href="#exercise-5" class="header-anchor">#</a> Exercise</h4> <p>Create a function that accept only temperature as an input using <code>partial</code> for <code>get_temperature</code> function from the previous exercise. Other arguments are given as $0 \leq t \leq 20$ given $\tau=5$, $T_0$ = 500 and  $T_\mathrm{rise}$ = 200.
Check if they give the same value for at any random t value.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> functools <span class="token keyword">import</span> partial
<span class="token keyword">import</span> random

get_temperature_only_from_time_input <span class="token operator">=</span> partial<span class="token punctuation">(</span>
    get_temperature<span class="token punctuation">,</span>
    initial_temperature <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">,</span>
    rise_temperature<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span>
    tau<span class="token operator">=</span><span class="token number">5</span>
<span class="token punctuation">)</span>

time <span class="token operator">=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span>
<span class="token keyword">assert</span> get_temperature<span class="token punctuation">(</span>
    time<span class="token punctuation">,</span>
    initial_temperature<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>
    rise_temperature<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span>
    tau<span class="token operator">=</span><span class="token number">5</span>
<span class="token punctuation">)</span> <span class="token operator">==</span> get_temperature_only_from_time_input<span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;The partial function is not identical.&quot;</span>
</code></pre></div><h3 id="creating-plot"><a href="#creating-plot" class="header-anchor">#</a> Creating plot</h3> <p>First the package for plotting should be imported. This is how everyone does.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> plotly<span class="token punctuation">.</span>subplots <span class="token keyword">import</span> make_subplots
</code></pre></div><p><code>plt.plot(x, y)</code> is the easiest way to start.</p> <div class="language-python extra-class"><pre class="language-python"><code>fig <span class="token operator">=</span> make_subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span>renderer<span class="token operator">=</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/TMR4222_2023S/assets/img/00_Numerical_Method_in_Python_44_0.c72cd752.svg" alt="svg"></p> <p>We usually want to have control over different elements in the plot such as legends, labels,
range, colors, line styles, etc. These are usually handled through axes instance. So, we can
start plotting by creating a figure and axes that belongs to the figure.</p> <div class="language-python extra-class"><pre class="language-python"><code>fig <span class="token operator">=</span> make_subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>update_xaxes<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">&quot;label for x-axis&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>update_yaxes<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">&quot;label for y-axis&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span>renderer<span class="token operator">=</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/TMR4222_2023S/assets/img/00_Numerical_Method_in_Python_46_0.08730ec9.svg" alt="svg"></p> <h2 id="numerical-optimization"><a href="#numerical-optimization" class="header-anchor">#</a> Numerical Optimization</h2> <p>Numerical optimization in this course is used in two ways in this course:</p> <ul><li>Finding a root for an equation $f(x) = 0$</li> <li>Finding a minimum value and the corresponding argument for an objective function</li></ul> <h3 id="solving-an-equation"><a href="#solving-an-equation" class="header-anchor">#</a> Solving an equation</h3> <p>We can use <code>root</code> method from <code>scipy.optimize</code> to find a root for a equation $f(x) = 0$ where $x$
is a vector. The syntax for using the method is</p> <div class="language-python extra-class"><pre class="language-python"><code>root<span class="token punctuation">(</span>fun<span class="token punctuation">,</span> x0<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">'hybr'</span><span class="token punctuation">,</span> jac<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> tol<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> callback<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> options<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
</code></pre></div><p>fun, x0 must be given, and other arguments are optional. fun is a Python function of which the
return is supposed to be 0 (left side of the equation). x0 is a ndarray or list for the initial
guess for the solution. Here is a simple example for a second-order polynomial to solve.
$$ f(x) = x^2 - 5x  + 6 = 0$$</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> scipy<span class="token punctuation">.</span>optimize <span class="token keyword">import</span> root_scalar

<span class="token comment"># Setting the function to solve</span>
<span class="token keyword">def</span> <span class="token function">function_to_solve</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">-</span> <span class="token number">5</span><span class="token operator">*</span>x <span class="token operator">+</span> <span class="token number">6</span>

solution <span class="token operator">=</span> root_scalar<span class="token punctuation">(</span>function_to_solve<span class="token punctuation">,</span> x0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> x1<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>solution<span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>      converged: True
           flag: 'converged'
 function_calls: 10
     iterations: 9
           root: 2.0000000000000004
</code></pre></div><p>Note that only one solution is found from the solver. We can try again with a new initial guess.</p> <div class="language-python extra-class"><pre class="language-python"><code>solution <span class="token operator">=</span> root_scalar<span class="token punctuation">(</span>function_to_solve<span class="token punctuation">,</span> x0<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> x1<span class="token operator">=</span><span class="token number">5.1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>solution<span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>      converged: True
           flag: 'converged'
 function_calls: 10
     iterations: 9
           root: 2.9999999999999987
</code></pre></div><p>Now we found the other solution. Be aware of that the solution may not be found depending on the
initial guess or it gives another solution that you did not expect. It is a good practive to try
the method with different initial values to avoid such a surprise.</p> <h4 id="exercise-6"><a href="#exercise-6" class="header-anchor">#</a> Exercise</h4> <p>Find the time at which the temperature has reached 626.4<sup>o</sup>C using the partial function
from the previous exercise.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># We need to define a function to solve</span>
<span class="token keyword">def</span> <span class="token function">function_to_solve</span><span class="token punctuation">(</span>time<span class="token punctuation">:</span> Numeric<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Numeric<span class="token punctuation">:</span>
    <span class="token keyword">return</span> get_temperature_only_from_time_input<span class="token punctuation">(</span>time<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">626.4</span>

solution <span class="token operator">=</span> root_scalar<span class="token punctuation">(</span>function_to_solve<span class="token punctuation">,</span> x0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> x1<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>solution<span class="token punctuation">)</span>

<span class="token comment"># We can verify if the solution is correct</span>
<span class="token keyword">assert</span> <span class="token number">626.4</span> <span class="token operator">==</span> get_temperature_only_from_time_input<span class="token punctuation">(</span>solution<span class="token punctuation">.</span>root<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;The solution is not correct&quot;</span>
</code></pre></div><div class="language- extra-class"><pre><code>      converged: True
           flag: 'converged'
 function_calls: 9
     iterations: 8
           root: 4.998361704066028
</code></pre></div><h3 id="find-a-minimum-value"><a href="#find-a-minimum-value" class="header-anchor">#</a> Find a minimum value</h3> <p>In this course, we will only look at a scalar function with a single variable. To do that, we can
use <code>minimize_scalar</code> function from <code>scipy.optimize</code>. The syntax is</p> <div class="language-python extra-class"><pre class="language-python"><code>minimize_scalar<span class="token punctuation">(</span>fun<span class="token punctuation">,</span> bracket<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> bounds<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">'brent'</span><span class="token punctuation">,</span> tol<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> options<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
</code></pre></div><p>Here, we have to pass a function with a single variable. Often, we need to bound the search area
so that the algorithm does not search the solution in the unexpected region. In that case, it is
recommended to use 'bounded' method. Let us recall the function we used for finding the thermal
resistance for an insulated pipe.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_total_thermal_resistance_cylinder_with_insulation</span><span class="token punctuation">(</span>
    wall_thickness<span class="token punctuation">:</span> Numeric<span class="token punctuation">,</span>
    inner_radius<span class="token punctuation">:</span> Numeric<span class="token punctuation">,</span>
    thermal_conductivity<span class="token punctuation">:</span> Numeric<span class="token punctuation">,</span>
    convection_coefficient<span class="token punctuation">:</span> Numeric<span class="token punctuation">,</span>
    length<span class="token punctuation">:</span> Numeric
<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Numeric<span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;Returns total thermal resistance&quot;&quot;&quot;</span>
    outer_radius <span class="token operator">=</span> inner_radius <span class="token operator">+</span> wall_thickness
    resistance_insulation <span class="token operator">=</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>outer_radius <span class="token operator">/</span> inner_radius<span class="token punctuation">)</span> <span class="token operator">/</span> \
                            <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>pi <span class="token operator">*</span> thermal_conductivity <span class="token operator">*</span> length<span class="token punctuation">)</span>
    outer_area <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>pi <span class="token operator">*</span> outer_radius <span class="token operator">*</span> length
    resistance_convection <span class="token operator">=</span>  <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span>convection_coefficient <span class="token operator">*</span> outer_area<span class="token punctuation">)</span>
    <span class="token keyword">return</span> resistance_insulation <span class="token operator">+</span> resistance_convection
</code></pre></div><p>In this function, the wall thickness should be always greater than 0. There is no meaning to
search the function with negative values of the wall thickness. Therefore, we use <code>bounded</code> as a
method finding the minimum value.</p> <h4 id="exercise-7"><a href="#exercise-7" class="header-anchor">#</a> Exercise</h4> <p>Create a <code>function_to_minimize</code> from <code>get_total_thermal_resistance_cylinder_with_insulation</code> with
the wall_thickness as an input. Other values are given as $r_i$ = 5 mm, $k_\mathrm{insulation}$
=  0.055 W/mK, $h_\mathrm{surr}$ = 5 W/m<sup>2</sup>K, length = 1m. Then use the
<code>minimize_scalar</code> function to find the minimum value for the function in the thickness between 0
and 100mm.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> scipy<span class="token punctuation">.</span>optimize <span class="token keyword">import</span> minimize_scalar

function_to_minimize <span class="token operator">=</span> partial<span class="token punctuation">(</span>
    get_total_thermal_resistance_cylinder_with_insulation<span class="token punctuation">,</span>
    inner_radius<span class="token operator">=</span><span class="token number">0.005</span><span class="token punctuation">,</span>
    thermal_conductivity<span class="token operator">=</span><span class="token number">0.055</span><span class="token punctuation">,</span>
    convection_coefficient<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>
    length<span class="token operator">=</span><span class="token number">1</span>
<span class="token punctuation">)</span>

thickness_array <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">)</span>
resistance_total_array <span class="token operator">=</span> function_to_minimize<span class="token punctuation">(</span>thickness_array<span class="token punctuation">)</span>
fig <span class="token operator">=</span> make_subplots<span class="token punctuation">(</span>x_title<span class="token operator">=</span><span class="token string">&quot;thickness [m]&quot;</span><span class="token punctuation">,</span> y_title<span class="token operator">=</span><span class="token string">&quot;Resistance&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>thickness_array<span class="token punctuation">,</span> y<span class="token operator">=</span>resistance_total_array<span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span>renderer<span class="token operator">=</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span>


solution <span class="token operator">=</span> minimize_scalar<span class="token punctuation">(</span>function_to_minimize<span class="token punctuation">,</span> bounds<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">'bounded'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>solution<span class="token punctuation">)</span>
</code></pre></div><p><img src="/TMR4222_2023S/assets/img/00_Numerical_Method_in_Python_59_0.17d56bf7.svg" alt="svg"></p> <div class="language- extra-class"><pre><code> message: Solution found.
 success: True
  status: 0
     fun: 5.175305989335323
       x: 0.005999939767216146
     nit: 12
    nfev: 12
</code></pre></div><h2 id="numerical-integration-solving-ode"><a href="#numerical-integration-solving-ode" class="header-anchor">#</a> Numerical Integration / Solving ODE</h2> <p>Often, we get an differential equation for our engineering problem, especially when we need to
handle temporal changes. In many cases, we end up with an ordinary differential equation that
looks like
$$\dot{x} = f(x, t)$$
When the differential function is in this form, we call it ordinary differential equation (ODE).
Other form of the differential equation is
$$f(x, \dot{x}, t) = 0$$
which is called a differential algebraic equation.
For ODE, $x(t)$ is found by
$$x(t) = x(0) + \int_0^t f(x, \tau) d\tau$$
This integration can be done numerically. You can think of Simpson's rule, for example, as an
integrator for the given function. Only the difference is that for Simpson's rule we know all the
values of the function to integrate whereas we need to guess the next value of the function from
the current value and the gradient. See below figure for the scheme of the Eulers method which is
in the simplest form of the ODE solver.
</p><p style="text-align:center;"><img src="/TMR4222_2023S/assets/img/00_EulerMethod.7fa7abed.png" alt="Euler's method" width="400"></p><p></p> <h3 id="using-solve-ivp"><a href="#using-solve-ivp" class="header-anchor">#</a> Using solve_ivp</h3> <p>Once you set up a function for the derivative of the states, we can use the ODE solver in the
python. The most generic method to use is <code>solve_ivp</code> from <code>scipy.integrate</code>. The syntax of the
method is</p> <div class="language-python extra-class"><pre class="language-python"><code>solve_ivp<span class="token punctuation">(</span>fun<span class="token punctuation">,</span> t_span<span class="token punctuation">,</span> y0<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">'RK45'</span><span class="token punctuation">,</span> t_eval<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> dense_output<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> events<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
vectorized<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token operator">**</span>options<span class="token punctuation">)</span>
</code></pre></div><p>Here <code>fun</code> argument is the derivative function $\dot{x}$ as a function of $t$ and $x$. The first
argument of the function should be time and the second $x$. <code>t_span</code> is the time interval of the
integration given as a tuple, <code>(t_start, t_end)</code>. It returns an ODEResult object which has the
following attributes:</p> <ul><li><code>t</code>: Time points</li> <li><code>z</code>: Values of the solution at <code>t</code></li> <li><code>success</code>: True if the solver reached the interval end or a termination event occurred
(<code>status &gt;= 0</code>)</li> <li>others</li></ul> <h4 id="example"><a href="#example" class="header-anchor">#</a> Example</h4> <p>Solve the differential equation
$$\dot(x) = x^2 - 4x + sin(t)$$
for $x(0) = 0$ and $0 \leq t \leq 10$ and plot the result</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> scipy<span class="token punctuation">.</span>integrate <span class="token keyword">import</span> solve_ivp

<span class="token keyword">def</span> <span class="token function">diff_equation_to_solve</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">-</span> <span class="token number">4</span><span class="token operator">*</span>x <span class="token operator">+</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>time<span class="token punctuation">)</span>
x0 <span class="token operator">=</span> <span class="token number">0</span>
solution <span class="token operator">=</span> solve_ivp<span class="token punctuation">(</span>diff_equation_to_solve<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>x0<span class="token punctuation">]</span><span class="token punctuation">)</span>

fig <span class="token operator">=</span> make_subplots<span class="token punctuation">(</span>x_title<span class="token operator">=</span><span class="token string">&quot;time [x]&quot;</span><span class="token punctuation">,</span> y_title<span class="token operator">=</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>solution<span class="token punctuation">.</span>t<span class="token punctuation">,</span> y<span class="token operator">=</span>solution<span class="token punctuation">.</span>y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span>renderer<span class="token operator">=</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/TMR4222_2023S/assets/img/00_Numerical_Method_in_Python_62_0.270ee659.svg" alt="svg"></p> <p>####Exercise
We have the rate of change in temperature equation given for a control volume.
$$\dot{T} = \dot{Q}<em>t-\frac{h \cdot A}{m c_p}\left(T - T</em>\mathrm{surr}\right)$$</p> <p>First, create a function for $\dot{T}$ in function of $T$ and $t$. $\dot{Q}_t$ is also a
function in time that can be defined later. This means that the function for $\dot{T}$ should
take $\dot{Q}_t$ function an additional argument.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># Your code here</span>
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Callable

<span class="token keyword">def</span> <span class="token function">temperature_rate</span><span class="token punctuation">(</span>
        time<span class="token punctuation">:</span> Numeric<span class="token punctuation">,</span>
        temperature<span class="token punctuation">:</span> Numeric<span class="token punctuation">,</span>
        heat_input<span class="token punctuation">:</span> Callable<span class="token punctuation">[</span><span class="token punctuation">[</span>Numeric<span class="token punctuation">]</span><span class="token punctuation">,</span> Numeric<span class="token punctuation">]</span><span class="token punctuation">,</span>
        heat_transfer_coefficient<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">,</span>
        area<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">,</span>
        mass<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">,</span>
        c_p<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">,</span>
        surrounding_temperature<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Numeric<span class="token punctuation">:</span>
    <span class="token keyword">return</span> heat_input<span class="token punctuation">(</span>time<span class="token punctuation">)</span> <span class="token operator">-</span> \
           heat_transfer_coefficient <span class="token operator">*</span> area <span class="token operator">/</span> <span class="token punctuation">(</span>mass <span class="token operator">*</span> c_p<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>temperature <span class="token operator">-</span> surrounding_temperature<span class="token punctuation">)</span>
</code></pre></div><p>Given</p> <ul><li>$\dot{Q}_t = sin(0.209t)$</li> <li>$h$=2 W/m<sup>2</sup></li> <li>$A$=100 m<sup>2</sup></li> <li>$m$=1000 kg</li> <li>$c_p$=300J/kgK</li> <li>$T_\mathrm$ = 20 <sup>o</sup>C, define a function to solve and solve the differential
equation for $T_0 = 100$, $0 \leq t \leq 100$.</li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">heat_input</span><span class="token punctuation">(</span>time<span class="token punctuation">:</span> Numeric<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Numeric<span class="token punctuation">:</span>
    <span class="token keyword">return</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span><span class="token number">0.209</span><span class="token operator">*</span>time<span class="token punctuation">)</span>

function_to_solve <span class="token operator">=</span> partial<span class="token punctuation">(</span>
    temperature_rate<span class="token punctuation">,</span>
    heat_input<span class="token operator">=</span>heat_input<span class="token punctuation">,</span>
    heat_transfer_coefficient<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
    area<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>
    mass<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">,</span>
    c_p<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span>
    surrounding_temperature<span class="token operator">=</span><span class="token number">20</span>
<span class="token punctuation">)</span>

solution <span class="token operator">=</span> solve_ivp<span class="token punctuation">(</span>function_to_solve<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

fig <span class="token operator">=</span> make_subplots<span class="token punctuation">(</span>x_title<span class="token operator">=</span><span class="token string">&quot;Time [s]&quot;</span><span class="token punctuation">,</span> y_title<span class="token operator">=</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>solution<span class="token punctuation">.</span>t<span class="token punctuation">,</span> y<span class="token operator">=</span>solution<span class="token punctuation">.</span>y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span>renderer<span class="token operator">=</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/TMR4222_2023S/assets/img/00_Numerical_Method_in_Python_66_0.cd537342.svg" alt="svg"></p> <p>Since the output seems to be a bit coarse, we want to see the result in a finer grid.</p> <div class="language-python extra-class"><pre class="language-python"><code>t_eval <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">10001</span><span class="token punctuation">)</span>
solution <span class="token operator">=</span> solve_ivp<span class="token punctuation">(</span>function_to_solve<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_eval<span class="token operator">=</span>t_eval<span class="token punctuation">)</span>

fig <span class="token operator">=</span> make_subplots<span class="token punctuation">(</span>x_title<span class="token operator">=</span><span class="token string">&quot;Time [s]&quot;</span><span class="token punctuation">,</span> y_title<span class="token operator">=</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>solution<span class="token punctuation">.</span>t<span class="token punctuation">,</span> y<span class="token operator">=</span>solution<span class="token punctuation">.</span>y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span>renderer<span class="token operator">=</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/TMR4222_2023S/assets/img/00_Numerical_Method_in_Python_68_0.7426c501.svg" alt="svg"></p> <h2 id="further-dive-into-the-scientific-calculation-with-python"><a href="#further-dive-into-the-scientific-calculation-with-python" class="header-anchor">#</a> Further dive into the scientific calculation with python</h2> <p>Please refer to <a href="https://scipy-lectures.org/index.html" target="_blank" rel="noopener noreferrer">Scypy Lecture Notes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> if you want to find
more about the scipy and numpy.</p> <p>Here are more packages that might be interesting for other application.</p> <ol><li><a href="https://pandas.pydata.org" target="_blank" rel="noopener noreferrer">pandas<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: data analysis and manipulation tool</li> <li><a href="https://www.sympy.org/en/index.html" target="_blank" rel="noopener noreferrer">SymPy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: Python library for symbolic mathematics.</li> <li><a href="https://scikit-learn.org/stable/index.html" target="_blank" rel="noopener noreferrer">scikit-learn<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: open source machine learning
library that supports supervised and unsupervised learning.</li> <li><a href="https://keras.io" target="_blank" rel="noopener noreferrer">keras<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: library that provides a Python interface for artificial neural
networks using TensorFlow.</li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/TMR4222_2023S/python-with-anaconda/" class="prev">
        Python with Anaconda
      </a></span> <span class="next"><a href="/TMR4222_2023S/pipe-friction/">
        Pipe Friction
      </a>
      
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/TMR4222_2023S/assets/js/app.4abb8553.js" defer></script><script src="/TMR4222_2023S/assets/js/2.2891b1df.js" defer></script><script src="/TMR4222_2023S/assets/js/4.56bc5be8.js" defer></script>
  </body>
</html>
