<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Pump Theory and Performance | TMR4222 Marine Machinery - Viscous Flow in Pipes</title>
    <meta name="generator" content="VuePress 1.9.8">
    <script type="text/javascript" src="https://polyfill.io/v3/polyfill.js?features=es6"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>
    <meta name="description" content="Documentation for TMR4222 Viscous Flow in Pipe">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/TMR4222_2023S/assets/css/0.styles.4543153c.css" as="style"><link rel="preload" href="/TMR4222_2023S/assets/js/app.4abb8553.js" as="script"><link rel="preload" href="/TMR4222_2023S/assets/js/2.2891b1df.js" as="script"><link rel="preload" href="/TMR4222_2023S/assets/js/3.2051a86c.js" as="script"><link rel="prefetch" href="/TMR4222_2023S/assets/js/10.2f61165d.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/11.2d18e7c2.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/12.3587cb85.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/13.f4be4253.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/14.25aae0a8.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/15.9724357a.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/16.b87e2b3e.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/17.ce1966c7.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/4.56bc5be8.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/5.c3e09589.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/6.ff7d345b.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/7.703bd4b0.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/8.6b2ef9ff.js"><link rel="prefetch" href="/TMR4222_2023S/assets/js/9.8906a95d.js">
    <link rel="stylesheet" href="/TMR4222_2023S/assets/css/0.styles.4543153c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TMR4222_2023S/" class="home-link router-link-active"><!----> <span class="site-name">TMR4222 Marine Machinery - Viscous Flow in Pipes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/TMR4222_2023S/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/TMR4222_2023S/python-with-anaconda/" class="sidebar-link">Python with Anaconda</a></li><li><a href="/TMR4222_2023S/numerical-method-python/" class="sidebar-link">Numerical method in Python</a></li><li><a href="/TMR4222_2023S/pipe-friction/" class="sidebar-link">Pipe Friction</a></li><li><a href="/TMR4222_2023S/pipe-network-analysis/" class="sidebar-link">Pipe Network Analysis</a></li><li><a href="/TMR4222_2023S/pump-performance/" aria-current="page" class="active sidebar-link">Pump Performance</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TMR4222_2023S/pump-performance/#_1-pump-analysis-using-the-euler-s-equation-and-velocity-triangle" class="sidebar-link">1. Pump analysis using the Euler's equation and velocity triangle</a></li><li class="sidebar-sub-header"><a href="/TMR4222_2023S/pump-performance/#_2-pump-performance-curve-and-calculating-the-power-consumption" class="sidebar-link">2. Pump performance curve and calculating the power consumption</a></li><li class="sidebar-sub-header"><a href="/TMR4222_2023S/pump-performance/#_3-pump-operating-point" class="sidebar-link">3. Pump Operating Point</a></li><li class="sidebar-sub-header"><a href="/TMR4222_2023S/pump-performance/#_4-net-suction-positive-head-npsh-for-pump" class="sidebar-link">4. Net Suction Positive Head (NPSH) for pump</a></li></ul></li><li><a href="/TMR4222_2023S/pump-control/" class="sidebar-link">Pump Control</a></li><li><a href="/TMR4222_2023S/positive-displacement-pump/" class="sidebar-link">Positive Displacement Pump</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="pump-theory-and-performance"><a href="#pump-theory-and-performance" class="header-anchor">#</a> Pump Theory and Performance</h1> <p>First, we will import the necessary packages to solve the problems.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> fluids <span class="token keyword">import</span> friction<span class="token punctuation">,</span> core<span class="token punctuation">,</span> fittings
<span class="token keyword">from</span> fluids<span class="token punctuation">.</span>piping <span class="token keyword">import</span> nearest_pipe
<span class="token keyword">from</span> pyfluids <span class="token keyword">import</span> Fluid<span class="token punctuation">,</span> FluidsList<span class="token punctuation">,</span> Input
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>optimize <span class="token keyword">import</span> root_scalar
<span class="token keyword">from</span> plotly<span class="token punctuation">.</span>subplots <span class="token keyword">import</span> make_subplots
<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>interpolate <span class="token keyword">import</span> interp1d

pd<span class="token punctuation">.</span>options<span class="token punctuation">.</span>plotting<span class="token punctuation">.</span>backend <span class="token operator">=</span> <span class="token string">&quot;plotly&quot;</span>
</code></pre></div><h2 id="_1-pump-analysis-using-the-euler-s-equation-and-velocity-triangle"><a href="#_1-pump-analysis-using-the-euler-s-equation-and-velocity-triangle" class="header-anchor">#</a> 1. Pump analysis using the Euler's equation and velocity triangle</h2> <p>Given the following data for a centrifugal water pump, estimate</p> <ul><li>the design point discharge</li> <li>the power delivered to the water</li> <li>the head</li></ul> <p>Given:</p> <ul><li>Radius at inlet and outlet: 0.1m 0.175m</li> <li>Blade angle at inlet and outlet: \(30^o\), \(20^o\)</li> <li>Impeller speed: 1440 revolution per min (RPM)</li> <li>Impeller width at inlet and outlet: 4.25cm</li></ul> <p style="text-align:center;">
============== Answer ==============
</p> <p>Let's assume that there is no rotation in the inlet water. Therefore, the velocity triangle at the inlet will look like following:</p> <p style="text-align:center;"><img src="/TMR4222_2023S/assets/img/pump_analysis_inlet_triangle1.b161c2a3.png" alt="Inlet velocity triangle" width="200"></p> <p>Then, the discharge rate can be obtained as such:</p> <div class="language-python extra-class"><pre class="language-python"><code>water <span class="token operator">=</span> Fluid<span class="token punctuation">(</span>FluidsList<span class="token punctuation">.</span>Water<span class="token punctuation">)</span><span class="token punctuation">.</span>with_state<span class="token punctuation">(</span>
    Input<span class="token punctuation">.</span>pressure<span class="token punctuation">(</span><span class="token number">1e5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Input<span class="token punctuation">.</span>temperature<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
inlet_impeller_radius_m <span class="token operator">=</span> <span class="token number">0.10</span>
outlet_impeller_radius_m <span class="token operator">=</span> <span class="token number">0.175</span>
inlet_blade_angle_deg <span class="token operator">=</span> <span class="token number">30</span>
outlet_blade_angle_deg <span class="token operator">=</span> <span class="token number">20</span>
impeller_rotation_speed_rpm <span class="token operator">=</span> <span class="token number">1440</span>
impeller_width_m <span class="token operator">=</span> <span class="token number">0.0425</span>

<span class="token comment"># First convert the values to SI units</span>
impeller_rotation_speed_rad_per_s <span class="token operator">=</span> <span class="token number">1440</span> <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>pi

<span class="token comment"># Calculate the velocities</span>
u1 <span class="token operator">=</span> impeller_rotation_speed_rad_per_s <span class="token operator">*</span> inlet_impeller_radius_m
v1 <span class="token operator">=</span> u1 <span class="token operator">*</span> np<span class="token punctuation">.</span>tan<span class="token punctuation">(</span>np<span class="token punctuation">.</span>deg2rad<span class="token punctuation">(</span>inlet_blade_angle_deg<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Velocities:\n\t u1 = </span><span class="token interpolation"><span class="token punctuation">{</span>u1<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> m/s \n\t v1 = </span><span class="token interpolation"><span class="token punctuation">{</span>v1<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> m/s&quot;</span></span><span class="token punctuation">)</span>

<span class="token comment"># Plot the velocity triangle</span>
<span class="token keyword">def</span> <span class="token function">plot_velocity_triangle</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> v<span class="token punctuation">,</span> alpha_deg<span class="token punctuation">,</span> beta_deg<span class="token punctuation">)</span><span class="token punctuation">:</span>
    fig <span class="token operator">=</span> make_subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
    fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> u<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;u&quot;</span><span class="token punctuation">)</span>
    alpha_rad <span class="token operator">=</span> np<span class="token punctuation">.</span>deg2rad<span class="token punctuation">(</span>alpha_deg<span class="token punctuation">)</span>
    fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> v <span class="token operator">*</span> np<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>alpha_rad<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> v <span class="token operator">*</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>alpha_rad<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;v&quot;</span><span class="token punctuation">)</span>
    fig<span class="token punctuation">.</span>update_layout<span class="token punctuation">(</span>height<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span>
    fig<span class="token punctuation">.</span>update_yaxes<span class="token punctuation">(</span>scaleanchor<span class="token operator">=</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">,</span> scaleratio<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span>renderer<span class="token operator">=</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span>

plot_velocity_triangle<span class="token punctuation">(</span>
    u<span class="token operator">=</span>u1<span class="token punctuation">,</span> 
    v<span class="token operator">=</span>v1<span class="token punctuation">,</span> 
    alpha_deg<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">,</span>
    beta_deg<span class="token operator">=</span>inlet_blade_angle_deg
<span class="token punctuation">)</span>

<span class="token comment"># Calculate the flow rate</span>
<span class="token keyword">def</span> <span class="token function">get_flow_impeller_m3_per_s</span><span class="token punctuation">(</span>radial_velocity_m_per_s<span class="token punctuation">,</span> width_m<span class="token punctuation">,</span> radius_m<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>pi <span class="token operator">*</span> radius_m <span class="token operator">*</span> width_m <span class="token operator">*</span> radial_velocity_m_per_s

flow_rate_m3_per_s <span class="token operator">=</span> get_flow_impeller_m3_per_s<span class="token punctuation">(</span>
    radial_velocity_m_per_s<span class="token operator">=</span>v1<span class="token punctuation">,</span>
    width_m<span class="token operator">=</span>impeller_width_m<span class="token punctuation">,</span>
    radius_m<span class="token operator">=</span>inlet_impeller_radius_m
<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Flow rate: </span><span class="token interpolation"><span class="token punctuation">{</span>flow_rate_m3_per_s <span class="token operator">*</span> <span class="token number">3600</span><span class="token punctuation">:</span><span class="token format-spec">.1f</span><span class="token punctuation">}</span></span><span class="token string"> m3/h&quot;</span></span><span class="token punctuation">)</span>

</code></pre></div><div class="language- extra-class"><pre><code>Velocities:
	 u1 = 15.08 m/s 
	 v1 = 8.71 m/s
</code></pre></div><p><img src="/TMR4222_2023S/assets/img/03_Centrifugal_Pump_Performance_4_1.92607b7a.svg" alt="svg"></p> <div class="language- extra-class"><pre><code>Flow rate: 837.0 m3/h
</code></pre></div><p>The velocity triangle can be drawn for the outlet from the given conditions. The radial velocity \(V_n2\) can be determined from flow rate calculated.</p> <p style="text-align:center;"><img src="/TMR4222_2023S/assets/img/pump_analysis_outlet_triangle1.ceaaed4d.png" alt="Inlet velocity triangle" width="200"></p> <div class="language-python extra-class"><pre class="language-python"><code>u2 <span class="token operator">=</span> outlet_impeller_radius_m <span class="token operator">*</span> impeller_rotation_speed_rad_per_s
area_outlet_m2 <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>pi <span class="token operator">*</span> outlet_impeller_radius_m <span class="token operator">*</span> impeller_width_m
v_n2 <span class="token operator">=</span> flow_rate_m3_per_s <span class="token operator">/</span> area_outlet_m2
v_t2 <span class="token operator">=</span> u2 <span class="token operator">-</span> v_n2 <span class="token operator">/</span> np<span class="token punctuation">.</span>tan<span class="token punctuation">(</span>np<span class="token punctuation">.</span>deg2rad<span class="token punctuation">(</span>outlet_blade_angle_deg<span class="token punctuation">)</span><span class="token punctuation">)</span>
power <span class="token operator">=</span> water<span class="token punctuation">.</span>density <span class="token operator">*</span> flow_rate_m3_per_s <span class="token operator">*</span> <span class="token punctuation">(</span>u2 <span class="token operator">*</span> v_t2<span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Power: </span><span class="token interpolation"><span class="token punctuation">{</span>power<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> W&quot;</span></span><span class="token punctuation">)</span>

alpha <span class="token operator">=</span> np<span class="token punctuation">.</span>degrees<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arctan<span class="token punctuation">(</span>v_n2 <span class="token operator">/</span> v_t2<span class="token punctuation">)</span><span class="token punctuation">)</span>
v2 <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>v_n2<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> v_t2<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>
plot_velocity_triangle<span class="token punctuation">(</span>u<span class="token operator">=</span>u2<span class="token punctuation">,</span> v<span class="token operator">=</span>v2<span class="token punctuation">,</span> alpha_deg<span class="token operator">=</span>alpha<span class="token punctuation">,</span> beta_deg<span class="token operator">=</span>outlet_blade_angle_deg<span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>Power: 77904.01 W
</code></pre></div><p><img src="/TMR4222_2023S/assets/img/03_Centrifugal_Pump_Performance_6_1.800dc66f.svg" alt="svg"></p> <p>The head can be estimated the assumption that there is no flow or energy loss in the impeller.</p> <div class="language-python extra-class"><pre class="language-python"><code>gravitational_acc_m2_per_s <span class="token operator">=</span> <span class="token number">9.81</span>
head <span class="token operator">=</span> power <span class="token operator">/</span> <span class="token punctuation">(</span>water<span class="token punctuation">.</span>density <span class="token operator">*</span> gravitational_acc_m2_per_s <span class="token operator">*</span> flow_rate_m3_per_s<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Head is </span><span class="token interpolation"><span class="token punctuation">{</span>head<span class="token punctuation">:</span><span class="token format-spec">.1f</span><span class="token punctuation">}</span></span><span class="token string"> m&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>Head is 34.2 m
</code></pre></div><p>As we have seen, we usually ignore the tangential velocity of the inlet flow. Then,</p> <p>$$
P_w = \rho Q u_2 V_{t2}
$$</p> <p>where</p> <p>$$
V_{t2} = u_2 - V_{n2} cot \beta_2 \quad V_{n2} = \frac{Q}{2\pi r_2 b_2}
$$</p> <p>From, the above we get</p> <p>$$
H\approx \frac{u_2^2}{g} - \frac{u_2 \cot \beta_2}{2 \pi r_2 b_2 g}Q
$$</p> <h2 id="_2-pump-performance-curve-and-calculating-the-power-consumption"><a href="#_2-pump-performance-curve-and-calculating-the-power-consumption" class="header-anchor">#</a> 2. Pump performance curve and calculating the power consumption</h2> <p>Given the following pump performance curve, estimate the power consumption for flows.</p> <table><thead><tr><th style="text-align:right;">Flow [m3/h]</th> <th style="text-align:right;">head [m]</th> <th style="text-align:right;">efficiency</th></tr></thead> <tbody><tr><td style="text-align:right;">0</td> <td style="text-align:right;">207</td> <td style="text-align:right;">0</td></tr> <tr><td style="text-align:right;">250</td> <td style="text-align:right;">204</td> <td style="text-align:right;">0.23</td></tr> <tr><td style="text-align:right;">500</td> <td style="text-align:right;">200</td> <td style="text-align:right;">0.41</td></tr> <tr><td style="text-align:right;">750</td> <td style="text-align:right;">195</td> <td style="text-align:right;">0.54</td></tr> <tr><td style="text-align:right;">1000</td> <td style="text-align:right;">189</td> <td style="text-align:right;">0.65</td></tr> <tr><td style="text-align:right;">1250</td> <td style="text-align:right;">182</td> <td style="text-align:right;">0.72</td></tr> <tr><td style="text-align:right;">1500</td> <td style="text-align:right;">174</td> <td style="text-align:right;">0.77</td></tr> <tr><td style="text-align:right;">1750</td> <td style="text-align:right;">165</td> <td style="text-align:right;">0.80</td></tr> <tr><td style="text-align:right;">2000</td> <td style="text-align:right;">152</td> <td style="text-align:right;">0.79</td></tr></tbody></table> <p>The fluid is water at ambient temperature.</p> <div class="language-python extra-class"><pre class="language-python"><code>fluid <span class="token operator">=</span> Fluid<span class="token punctuation">(</span>FluidsList<span class="token punctuation">.</span>Water<span class="token punctuation">)</span><span class="token punctuation">.</span>with_state<span class="token punctuation">(</span>Input<span class="token punctuation">.</span>pressure<span class="token punctuation">(</span><span class="token number">1e5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Input<span class="token punctuation">.</span>temperature<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">&quot;Flow [m3/h]&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">750</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">1250</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">,</span> <span class="token number">1750</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">&quot;Head [m]&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">207</span><span class="token punctuation">,</span> <span class="token number">204</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">195</span><span class="token punctuation">,</span> <span class="token number">189</span><span class="token punctuation">,</span> <span class="token number">182</span><span class="token punctuation">,</span> <span class="token number">174</span><span class="token punctuation">,</span> <span class="token number">165</span><span class="token punctuation">,</span> <span class="token number">152</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">&quot;Efficiency&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.23</span><span class="token punctuation">,</span> <span class="token number">0.41</span><span class="token punctuation">,</span> <span class="token number">0.54</span><span class="token punctuation">,</span> <span class="token number">0.65</span><span class="token punctuation">,</span> <span class="token number">0.72</span><span class="token punctuation">,</span> <span class="token number">0.77</span><span class="token punctuation">,</span> <span class="token number">0.80</span><span class="token punctuation">,</span> <span class="token number">0.79</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">&quot;Power [kW]&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> \
    fluid<span class="token punctuation">.</span>density <span class="token operator">*</span> gravitational_acc_m2_per_s \
    <span class="token operator">*</span> df<span class="token punctuation">[</span><span class="token string">&quot;Flow [m3/h]&quot;</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">3600</span> \
    <span class="token operator">*</span> df<span class="token punctuation">[</span><span class="token string">&quot;Head [m]&quot;</span><span class="token punctuation">]</span> \
    <span class="token operator">/</span> df<span class="token punctuation">[</span><span class="token string">&quot;Efficiency&quot;</span><span class="token punctuation">]</span> \
    <span class="token operator">/</span> <span class="token number">1000</span>

fig <span class="token operator">=</span> make_subplots<span class="token punctuation">(</span>cols<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> rows<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> shared_xaxes<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Flow [m3/h]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Head [m]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Head&quot;</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Flow [m3/h]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Efficiency&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Efficiency&quot;</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Flow [m3/h]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Power [kW]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Power&quot;</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> row<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>update_layout<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">&quot;Pump performance curve&quot;</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">800</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">800</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>update_xaxes<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">&quot;Volume Flow [m3/h]&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>update_yaxes<span class="token punctuation">(</span>col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&quot;m3/h&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>update_yaxes<span class="token punctuation">(</span>col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> row<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&quot;kW&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span>renderer<span class="token operator">=</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/TMR4222_2023S/assets/img/03_Centrifugal_Pump_Performance_11_0.451646e4.svg" alt="svg"></p> <h2 id="_3-pump-operating-point"><a href="#_3-pump-operating-point" class="header-anchor">#</a> 3. Pump Operating Point</h2> <p>For the pump given above, find the operating of the pump and the power consumption.</p> <h3 id="a-when-the-piping-system-is-given-as-belows"><a href="#a-when-the-piping-system-is-given-as-belows" class="header-anchor">#</a> a. When the piping system is given as belows:</h3> <ul><li>nominal diameter: 400A</li> <li>pipe material: stainless steel</li> <li>schedule: 40s</li> <li>length: 200m</li> <li>k value for fittings: 20</li></ul> <p>First let's look at our system. We can think of two different causalities for the system.
The first one is the flow is determined at pump whereas the pressure is determined in the branch or the piping system.
The other one is vice versa. Depending on the causalities we choose, the way to solve the equation will be
different. It is numerically less challenging and simpler to choose the first causality. It is physically natural also.</p> <p style="text-align:center;"><img src="/TMR4222_2023S/assets/img/03_Centrifugal_Pump_Performance_Pump_System.4e45af08.png" alt="Pumping system" width="400"></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># We are given</span>
nom_dia_m <span class="token operator">=</span> <span class="token number">0.20</span>
pipe_material <span class="token operator">=</span> <span class="token string">&quot;clean stainless steel pipe&quot;</span>
schedule <span class="token operator">=</span> <span class="token string">&quot;40S&quot;</span>
length_m <span class="token operator">=</span> <span class="token number">200</span>
k_value_fittings <span class="token operator">=</span> <span class="token number">20</span>
roughness <span class="token operator">=</span> friction<span class="token punctuation">.</span>material_roughness<span class="token punctuation">(</span>pipe_material<span class="token punctuation">)</span>

<span class="token comment"># Define a function to get pump efficiency by interpolation</span>
interpolate_function_for_efficiency <span class="token operator">=</span> interp1d<span class="token punctuation">(</span>
    x<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Flow [m3/h]&quot;</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">3600</span><span class="token punctuation">,</span> y<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Efficiency&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> kind<span class="token operator">=</span><span class="token string">&quot;cubic&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_pump_efficiency</span><span class="token punctuation">(</span>flow_m3_per_s<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> interpolate_function_for_efficiency<span class="token punctuation">(</span>flow_m3_per_s<span class="token punctuation">)</span>

<span class="token comment"># We will define the function for the pressure drop for the branch</span>
<span class="token keyword">def</span> <span class="token function">get_head_loss_with_flow_input</span><span class="token punctuation">(</span>flow_m3_per_s<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">,</span> nom_dia_m<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;Returns the head loss from given the flow rate&quot;&quot;&quot;</span>
    _<span class="token punctuation">,</span> inner_dia_m<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _ <span class="token operator">=</span> nearest_pipe<span class="token punctuation">(</span>Di<span class="token operator">=</span>nom_dia_m<span class="token punctuation">,</span> schedule<span class="token operator">=</span>schedule<span class="token punctuation">)</span>
    pipe_section_area <span class="token operator">=</span> np<span class="token punctuation">.</span>pi <span class="token operator">*</span> inner_dia_m<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">/</span> <span class="token number">4</span>
    velocity_m_per_s <span class="token operator">=</span> flow_m3_per_s <span class="token operator">/</span> pipe_section_area
    pressure_drop_fitting <span class="token operator">=</span> core<span class="token punctuation">.</span>dP_from_K<span class="token punctuation">(</span>
        K<span class="token operator">=</span>k_value_fittings<span class="token punctuation">,</span> rho<span class="token operator">=</span>fluid<span class="token punctuation">.</span>density<span class="token punctuation">,</span> V<span class="token operator">=</span>velocity_m_per_s
    <span class="token punctuation">)</span>
    pressure_drop_pipe <span class="token operator">=</span> friction<span class="token punctuation">.</span>one_phase_dP<span class="token punctuation">(</span>
        m<span class="token operator">=</span>flow_m3_per_s <span class="token operator">*</span> fluid<span class="token punctuation">.</span>density<span class="token punctuation">,</span>
        rho<span class="token operator">=</span>fluid<span class="token punctuation">.</span>density<span class="token punctuation">,</span>
        mu<span class="token operator">=</span>fluid<span class="token punctuation">.</span>dynamic_viscosity<span class="token punctuation">,</span>
        D<span class="token operator">=</span>inner_dia_m<span class="token punctuation">,</span>
        roughness<span class="token operator">=</span>roughness<span class="token punctuation">,</span>
        L<span class="token operator">=</span>length_m
    <span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>pressure_drop_pipe <span class="token operator">+</span> pressure_drop_fitting<span class="token punctuation">)</span> \
           <span class="token operator">/</span> <span class="token punctuation">(</span>fluid<span class="token punctuation">.</span>density <span class="token operator">*</span> gravitational_acc_m2_per_s<span class="token punctuation">)</span>

<span class="token comment"># We will define the function for flow for the given head of the</span>
df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">&quot;Head [m]&quot;</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
interpolate_function <span class="token operator">=</span> interp1d<span class="token punctuation">(</span>
    x<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Head [m]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Flow [m3/h]&quot;</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">3600</span><span class="token punctuation">,</span> kind<span class="token operator">=</span><span class="token string">&quot;cubic&quot;</span><span class="token punctuation">,</span> fill_value<span class="token operator">=</span><span class="token string">&quot;extrapolate&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_flow_pump_m3_per_s</span><span class="token punctuation">(</span>head_m<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;Returns the flow of the pump from given the head&quot;&quot;&quot;</span>
    <span class="token keyword">return</span> interpolate_function<span class="token punctuation">(</span>head_m<span class="token punctuation">)</span>

<span class="token comment"># Let's plot the head loss in the piping system on the pump curve</span>
fig <span class="token operator">=</span> make_subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
flow_array_m3_per_h <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">&quot;Flow [m3/h]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
head_loss_array_m <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
    get_head_loss_with_flow_input<span class="token punctuation">(</span>flow_m3_per_s<span class="token operator">=</span>each_flow<span class="token operator">/</span><span class="token number">3600</span><span class="token punctuation">,</span> nom_dia_m<span class="token operator">=</span>nom_dia_m<span class="token punctuation">)</span>
    <span class="token keyword">for</span> each_flow <span class="token keyword">in</span> flow_array_m3_per_h
<span class="token punctuation">]</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>flow_array_m3_per_h<span class="token punctuation">,</span> y<span class="token operator">=</span>head_loss_array_m<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Head loss&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Flow [m3/h]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Head [m]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Pump curve&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>update_xaxes<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">&quot;Flow rate [m3/h]&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>update_yaxes<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">&quot;Pump head / head loss [m]&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span>renderer<span class="token operator">=</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/TMR4222_2023S/assets/img/03_Centrifugal_Pump_Performance_13_0.5156471c.svg" alt="svg"></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># Let's find the flow rate that satisfies both the pump curve and friction loss curve.</span>
<span class="token keyword">def</span> <span class="token function">function_to_solve</span><span class="token punctuation">(</span>flow_m3_per_s<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;Function to solve the flow for the problem&quot;&quot;&quot;</span>
    head_loss <span class="token operator">=</span> get_head_loss_with_flow_input<span class="token punctuation">(</span>flow_m3_per_s<span class="token operator">=</span>flow_m3_per_s<span class="token punctuation">,</span> nom_dia_m<span class="token operator">=</span>nom_dia_m<span class="token punctuation">)</span>
    pump_flow_m3_per_s <span class="token operator">=</span> get_flow_pump_m3_per_s<span class="token punctuation">(</span>head_loss<span class="token punctuation">)</span>
    <span class="token keyword">return</span> flow_m3_per_s <span class="token operator">-</span> pump_flow_m3_per_s
x0 <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">3600</span>
x1 <span class="token operator">=</span> <span class="token number">1010</span> <span class="token operator">/</span> <span class="token number">3600</span>
sol <span class="token operator">=</span> root_scalar<span class="token punctuation">(</span>f<span class="token operator">=</span>function_to_solve<span class="token punctuation">,</span> x0<span class="token operator">=</span>x0<span class="token punctuation">,</span> x1<span class="token operator">=</span>x1<span class="token punctuation">)</span>
head_pump_m <span class="token operator">=</span> get_head_loss_with_flow_input<span class="token punctuation">(</span>flow_m3_per_s<span class="token operator">=</span>sol<span class="token punctuation">.</span>root<span class="token punctuation">,</span> nom_dia_m<span class="token operator">=</span>nom_dia_m<span class="token punctuation">)</span>
efficiency <span class="token operator">=</span> get_pump_efficiency<span class="token punctuation">(</span>sol<span class="token punctuation">.</span>root<span class="token punctuation">)</span>
power_one_pump_w <span class="token operator">=</span> fluid<span class="token punctuation">.</span>density \
                   <span class="token operator">*</span> gravitational_acc_m2_per_s \
                   <span class="token operator">*</span> head_pump_m \
                   <span class="token operator">*</span> sol<span class="token punctuation">.</span>root \
                   <span class="token operator">/</span> efficiency
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The flow will be </span><span class="token interpolation"><span class="token punctuation">{</span>sol<span class="token punctuation">.</span>root <span class="token operator">*</span> <span class="token number">3600</span><span class="token punctuation">:</span><span class="token format-spec">.1f</span><span class="token punctuation">}</span></span><span class="token string"> m3/h&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The head at the outlet of the pump will be </span><span class="token interpolation"><span class="token punctuation">{</span>head_pump_m<span class="token punctuation">}</span></span><span class="token string"> m&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The efficiency is </span><span class="token interpolation"><span class="token punctuation">{</span>efficiency<span class="token punctuation">:</span><span class="token format-spec">.3f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The power is </span><span class="token interpolation"><span class="token punctuation">{</span>power_one_pump_w <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">:</span><span class="token format-spec">.0f</span><span class="token punctuation">}</span></span><span class="token string"> kW&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>The flow will be 1042.7 m3/h
The head at the outlet of the pump will be 187.87462245305443 m
The efficiency is 0.665
The power is 802 kW
</code></pre></div><h3 id="b-we-found-that-the-flow-is-less-than-expected-one-enginner-suggested-to-add-an-identical-pump-in-parallel-to-the-system-what-will-be-the-estimated-flow-and-head-with-the-new-configuration"><a href="#b-we-found-that-the-flow-is-less-than-expected-one-enginner-suggested-to-add-an-identical-pump-in-parallel-to-the-system-what-will-be-the-estimated-flow-and-head-with-the-new-configuration" class="header-anchor">#</a> b. We found that the flow is less than expected. One enginner suggested to add an identical pump in parallel to the system. What will be the estimated flow and head with the new configuration?</h3> <p>Now we have a new system.</p> <p style="text-align:center;"><img src="/TMR4222_2023S/assets/img/03_Centrifugal_Pump_Performance_Pump_System_Two_Pumps.9a5e0866.jpg" alt="Pumping system" width="400"></p> <p>From the causality above, we now know that will have the same head when operating in parallel. Then we can draw our curves for the total flow.</p> <div class="language-python extra-class"><pre class="language-python"><code>fig <span class="token operator">=</span> make_subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
flow_array_m3_per_h <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">&quot;Flow [m3/h]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
head_loss_array_m <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
    get_head_loss_with_flow_input<span class="token punctuation">(</span>flow_m3_per_s<span class="token operator">=</span>each_flow<span class="token operator">/</span><span class="token number">3600</span><span class="token punctuation">,</span> nom_dia_m<span class="token operator">=</span>nom_dia_m<span class="token punctuation">)</span>
    <span class="token keyword">for</span> each_flow <span class="token keyword">in</span> flow_array_m3_per_h
<span class="token punctuation">]</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>flow_array_m3_per_h<span class="token punctuation">,</span> y<span class="token operator">=</span>head_loss_array_m<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Head loss&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Flow [m3/h]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Head [m]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Pump curve 1 and 2&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Flow [m3/h]&quot;</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> y<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Head [m]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Pump curve for both&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>update_xaxes<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">&quot;Flow rate [m3/h]&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>update_yaxes<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">&quot;Pump head / head loss [m]&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span>renderer<span class="token operator">=</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/TMR4222_2023S/assets/img/03_Centrifugal_Pump_Performance_16_0.048f167b.svg" alt="svg"></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_pumps_flow_m3_per_s</span><span class="token punctuation">(</span>head_m<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> get_flow_pump_m3_per_s<span class="token punctuation">(</span>head_m<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span>

<span class="token keyword">def</span> <span class="token function">function_to_solve</span><span class="token punctuation">(</span>vol_flow_m3_per_s<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;Function to solve the problem&quot;&quot;&quot;</span>
    head_m <span class="token operator">=</span> get_head_loss_with_flow_input<span class="token punctuation">(</span>flow_m3_per_s<span class="token operator">=</span>vol_flow_m3_per_s<span class="token punctuation">,</span> nom_dia_m<span class="token operator">=</span>nom_dia_m<span class="token punctuation">)</span>
    pump_flow <span class="token operator">=</span> get_pumps_flow_m3_per_s<span class="token punctuation">(</span>head_m<span class="token punctuation">)</span>
    <span class="token keyword">return</span> vol_flow_m3_per_s <span class="token operator">-</span> pump_flow

x0 <span class="token operator">=</span> <span class="token number">1040</span> <span class="token operator">/</span> <span class="token number">3600</span>
x1 <span class="token operator">=</span> <span class="token number">1050</span> <span class="token operator">/</span> <span class="token number">3600</span>
sol <span class="token operator">=</span> root_scalar<span class="token punctuation">(</span>f<span class="token operator">=</span>function_to_solve<span class="token punctuation">,</span> x0<span class="token operator">=</span>x0<span class="token punctuation">,</span> x1<span class="token operator">=</span>x1<span class="token punctuation">)</span>
flow_m3_per_s <span class="token operator">=</span> sol<span class="token punctuation">.</span>root
head_pump_m <span class="token operator">=</span> get_head_loss_with_flow_input<span class="token punctuation">(</span>flow_m3_per_s<span class="token operator">=</span>flow_m3_per_s<span class="token punctuation">,</span> nom_dia_m<span class="token operator">=</span>nom_dia_m<span class="token punctuation">)</span>
flow_for_each_pump_m3_per_s <span class="token operator">=</span> flow_m3_per_s <span class="token operator">/</span> <span class="token number">2</span>
efficiency <span class="token operator">=</span> get_pump_efficiency<span class="token punctuation">(</span>flow_for_each_pump_m3_per_s<span class="token punctuation">)</span>
power_two_pump_w <span class="token operator">=</span> fluid<span class="token punctuation">.</span>density \
                   <span class="token operator">*</span> gravitational_acc_m2_per_s \
                   <span class="token operator">*</span> head_pump_m \
                   <span class="token operator">*</span> flow_m3_per_s \
                   <span class="token operator">/</span> efficiency
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The flow will be </span><span class="token interpolation"><span class="token punctuation">{</span>sol<span class="token punctuation">.</span>root <span class="token operator">*</span> <span class="token number">3600</span><span class="token punctuation">:</span><span class="token format-spec">.1f</span><span class="token punctuation">}</span></span><span class="token string"> m3/h&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The head at the outlet of the pump will be </span><span class="token interpolation"><span class="token punctuation">{</span>head_pump_m<span class="token punctuation">}</span></span><span class="token string"> m&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The efficiency is </span><span class="token interpolation"><span class="token punctuation">{</span>efficiency<span class="token punctuation">:</span><span class="token format-spec">.3f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The power is </span><span class="token interpolation"><span class="token punctuation">{</span>power_two_pump_w <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">:</span><span class="token format-spec">.0f</span><span class="token punctuation">}</span></span><span class="token string"> kW&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>The flow will be 1074.0 m3/h
The head at the outlet of the pump will be 199.31930760257043 m
The efficiency is 0.432
The power is 1349 kW
</code></pre></div><h3 id="c-what-about-having-the-pump-in-series"><a href="#c-what-about-having-the-pump-in-series" class="header-anchor">#</a> c. What about having the pump in series?</h3> <p style="text-align:center;"><img src="/TMR4222_2023S/assets/img/03_Centrifugal_Pump_Performance_Pump_System_Two_Pumps_Series.fe5b790a.jpg" alt="Pumping system" width="400"></p> <p>Here, we know that the pumps are identical and should have the same flow. Therefore, the head should be also identical. Therefore,</p> <p>$$
h_{l} = h_{p1} + h_{p2}
$$
$$
h_{l} = 2 h_{p}
$$</p> <div class="language-python extra-class"><pre class="language-python"><code>fig <span class="token operator">=</span> make_subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>flow_array_m3_per_h<span class="token punctuation">,</span> y<span class="token operator">=</span>head_loss_array_m<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Head loss&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Flow [m3/h]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Head [m]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Pump curve 1 and 2&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Flow [m3/h]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Head [m]&quot;</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Pump curve for both&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>update_xaxes<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">&quot;Flow rate [m3/h]&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>update_yaxes<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">&quot;Pump head / head loss [m]&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span>renderer<span class="token operator">=</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/TMR4222_2023S/assets/img/03_Centrifugal_Pump_Performance_19_0.e94891b6.svg" alt="svg"></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_pumps_flow_m3_per_s</span><span class="token punctuation">(</span>head_m<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
    head_for_each_pump_m <span class="token operator">=</span> head_m <span class="token operator">/</span> <span class="token number">2</span>
    <span class="token keyword">return</span> get_flow_pump_m3_per_s<span class="token punctuation">(</span>head_for_each_pump_m<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">function_to_solve</span><span class="token punctuation">(</span>vol_flow_m3_per_s<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;Function to solve the problem&quot;&quot;&quot;</span>
    head_m <span class="token operator">=</span> get_head_loss_with_flow_input<span class="token punctuation">(</span>
        flow_m3_per_s<span class="token operator">=</span>vol_flow_m3_per_s<span class="token punctuation">,</span> nom_dia_m<span class="token operator">=</span>nom_dia_m
    <span class="token punctuation">)</span>
    pump_flow <span class="token operator">=</span> get_pumps_flow_m3_per_s<span class="token punctuation">(</span>head_m<span class="token punctuation">)</span>
    <span class="token keyword">return</span> vol_flow_m3_per_s <span class="token operator">-</span> pump_flow

x0 <span class="token operator">=</span> <span class="token number">1450</span> <span class="token operator">/</span> <span class="token number">3600</span>
x1 <span class="token operator">=</span> <span class="token number">1460</span> <span class="token operator">/</span> <span class="token number">3600</span>
sol <span class="token operator">=</span> root_scalar<span class="token punctuation">(</span>f<span class="token operator">=</span>function_to_solve<span class="token punctuation">,</span> x0<span class="token operator">=</span>x0<span class="token punctuation">,</span> x1<span class="token operator">=</span>x1<span class="token punctuation">)</span>
flow_m3_per_s <span class="token operator">=</span> sol<span class="token punctuation">.</span>root
head_pump_two_pumps_series_m <span class="token operator">=</span> get_head_loss_with_flow_input<span class="token punctuation">(</span>
    flow_m3_per_s<span class="token operator">=</span>flow_m3_per_s<span class="token punctuation">,</span> nom_dia_m<span class="token operator">=</span>nom_dia_m
<span class="token punctuation">)</span>
efficiency <span class="token operator">=</span> get_pump_efficiency<span class="token punctuation">(</span>flow_m3_per_s<span class="token punctuation">)</span>
power_two_pump_w <span class="token operator">=</span> fluid<span class="token punctuation">.</span>density \
                   <span class="token operator">*</span> gravitational_acc_m2_per_s \
                   <span class="token operator">*</span> head_pump_two_pumps_series_m \
                   <span class="token operator">*</span> flow_m3_per_s \
                   <span class="token operator">/</span> efficiency
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The flow will be </span><span class="token interpolation"><span class="token punctuation">{</span>sol<span class="token punctuation">.</span>root <span class="token operator">*</span> <span class="token number">3600</span><span class="token punctuation">:</span><span class="token format-spec">.1f</span><span class="token punctuation">}</span></span><span class="token string"> m3/h&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The head at the outlet of the second pump will be </span><span class="token interpolation"><span class="token punctuation">{</span>head_pump_two_pumps_series_m<span class="token punctuation">:</span><span class="token format-spec">.1f</span><span class="token punctuation">}</span></span><span class="token string"> m&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The efficiency is </span><span class="token interpolation"><span class="token punctuation">{</span>efficiency<span class="token punctuation">:</span><span class="token format-spec">.3f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The power is </span><span class="token interpolation"><span class="token punctuation">{</span>power_two_pump_w <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">:</span><span class="token format-spec">.0f</span><span class="token punctuation">}</span></span><span class="token string"> kW&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>The flow will be 1429.1 m3/h
The head at the outlet of the second pump will be 352.7 m
The efficiency is 0.757
The power is 1810 kW
</code></pre></div><h3 id="d-someone-who-took-this-course-finally-suggests-that-we-should-just-increase-the-size-of-the-pipe-how-large-the-pipe-should-be-to-have-1429-1m-3-h-flow-what-would-be-power-consumption-at-this-size"><a href="#d-someone-who-took-this-course-finally-suggests-that-we-should-just-increase-the-size-of-the-pipe-how-large-the-pipe-should-be-to-have-1429-1m-3-h-flow-what-would-be-power-consumption-at-this-size" class="header-anchor">#</a> d. Someone who took this course finally suggests that we should just increase the size of the pipe. How large the pipe should be to have 1429.1m <sup>3</sup>/h flow? What would be power consumption at this size?</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># Let's define the head loss function in diameter of the pipe.</span>
head_for_pump_m <span class="token operator">=</span> head_pump_two_pumps_series_m <span class="token operator">/</span> <span class="token number">2</span>
<span class="token keyword">def</span> <span class="token function">get_head_loss_with_pipe_size_input</span><span class="token punctuation">(</span>inner_dia_m<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
    pipe_section_area <span class="token operator">=</span> np<span class="token punctuation">.</span>pi <span class="token operator">*</span> inner_dia_m<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">/</span> <span class="token number">4</span>
    velocity_m_per_s <span class="token operator">=</span> flow_m3_per_s <span class="token operator">/</span> pipe_section_area
    pressure_drop_fitting <span class="token operator">=</span> core<span class="token punctuation">.</span>dP_from_K<span class="token punctuation">(</span>
        K<span class="token operator">=</span>k_value_fittings<span class="token punctuation">,</span> rho<span class="token operator">=</span>fluid<span class="token punctuation">.</span>density<span class="token punctuation">,</span> V<span class="token operator">=</span>velocity_m_per_s
    <span class="token punctuation">)</span>
    pressure_drop_pipe <span class="token operator">=</span>  friction<span class="token punctuation">.</span>one_phase_dP<span class="token punctuation">(</span>
        m<span class="token operator">=</span>flow_m3_per_s <span class="token operator">*</span> fluid<span class="token punctuation">.</span>density<span class="token punctuation">,</span>
        rho<span class="token operator">=</span>fluid<span class="token punctuation">.</span>density<span class="token punctuation">,</span>
        mu<span class="token operator">=</span>fluid<span class="token punctuation">.</span>dynamic_viscosity<span class="token punctuation">,</span>
        D<span class="token operator">=</span>inner_dia_m<span class="token punctuation">,</span>
        roughness<span class="token operator">=</span>roughness<span class="token punctuation">,</span>
        L<span class="token operator">=</span>length_m
    <span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>pressure_drop_fitting <span class="token operator">+</span> pressure_drop_pipe<span class="token punctuation">)</span> \
           <span class="token operator">/</span> <span class="token punctuation">(</span>fluid<span class="token punctuation">.</span>density <span class="token operator">*</span> gravitational_acc_m2_per_s<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">function_to_solve</span><span class="token punctuation">(</span>inner_dia_m<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> head_for_pump_m <span class="token operator">-</span> get_head_loss_with_pipe_size_input<span class="token punctuation">(</span>inner_dia_m<span class="token punctuation">)</span>

sol <span class="token operator">=</span> root_scalar<span class="token punctuation">(</span>f<span class="token operator">=</span>function_to_solve<span class="token punctuation">,</span> x0<span class="token operator">=</span>nom_dia_m<span class="token punctuation">,</span> x1<span class="token operator">=</span>nom_dia_m<span class="token operator">*</span><span class="token number">1.1</span><span class="token punctuation">)</span>
inner_dia_m <span class="token operator">=</span> sol<span class="token punctuation">.</span>root
head_pump_m <span class="token operator">=</span> get_head_loss_with_pipe_size_input<span class="token punctuation">(</span>inner_dia_m<span class="token punctuation">)</span>
power_increased_dia <span class="token operator">=</span> fluid<span class="token punctuation">.</span>density \
                      <span class="token operator">*</span> gravitational_acc_m2_per_s \
                      <span class="token operator">*</span> flow_m3_per_s \
                      <span class="token operator">*</span> head_pump_m \
                      <span class="token operator">/</span> efficiency

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The volume flow: </span><span class="token interpolation"><span class="token punctuation">{</span>flow_m3_per_s <span class="token operator">*</span> <span class="token number">3600</span><span class="token punctuation">:</span><span class="token format-spec">.1f</span><span class="token punctuation">}</span></span><span class="token string"> m3/h &quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The increase diameter should be at least </span><span class="token interpolation"><span class="token punctuation">{</span>inner_dia_m <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">:</span><span class="token format-spec">.1f</span><span class="token punctuation">}</span></span><span class="token string">mm&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The head at the outlet of the pump will be </span><span class="token interpolation"><span class="token punctuation">{</span>head_pump_m<span class="token punctuation">:</span><span class="token format-spec">.1f</span><span class="token punctuation">}</span></span><span class="token string"> m&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The efficiency is </span><span class="token interpolation"><span class="token punctuation">{</span>efficiency<span class="token punctuation">:</span><span class="token format-spec">.3f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The power is </span><span class="token interpolation"><span class="token punctuation">{</span>power_increased_dia <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">:</span><span class="token format-spec">.0f</span><span class="token punctuation">}</span></span><span class="token string"> kW&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>The volume flow: 1429.1 m3/h 
The increase diameter should be at least 235.1mm
The head at the outlet of the pump will be 176.4 m
The efficiency is 0.757
The power is 905 kW
</code></pre></div><h3 id="e-what-is-the-weight-increase-to-increase-the-pipe-from-200a-to-250a"><a href="#e-what-is-the-weight-increase-to-increase-the-pipe-from-200a-to-250a" class="header-anchor">#</a> e. What is the weight increase to increase the pipe from 200A to 250A?</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># weight per length</span>
price_nok_per_kg <span class="token operator">=</span> <span class="token number">20</span>
density_stainless_steel_kg_per_m3 <span class="token operator">=</span> <span class="token number">7500</span>
<span class="token keyword">def</span> <span class="token function">get_weight_per_length</span><span class="token punctuation">(</span>nominal_dia_m<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">,</span> schedule<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;Calculates the weight per length for the pipe&quot;&quot;&quot;</span>
    _<span class="token punctuation">,</span> inner_dia_m<span class="token punctuation">,</span> outer_dia_m<span class="token punctuation">,</span> thickness <span class="token operator">=</span> nearest_pipe<span class="token punctuation">(</span>Di<span class="token operator">=</span>nominal_dia_m<span class="token punctuation">,</span> schedule<span class="token operator">=</span>schedule<span class="token punctuation">)</span>
    sectional_area <span class="token operator">=</span> np<span class="token punctuation">.</span>pi <span class="token operator">*</span> <span class="token punctuation">(</span>outer_dia_m<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">-</span> inner_dia_m<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">4</span>
    <span class="token keyword">return</span>  density_stainless_steel_kg_per_m3 <span class="token operator">*</span> sectional_area

weight_200a <span class="token operator">=</span> get_weight_per_length<span class="token punctuation">(</span>nominal_dia_m<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> schedule<span class="token operator">=</span>schedule<span class="token punctuation">)</span> <span class="token operator">*</span> length_m
weight_250a <span class="token operator">=</span> get_weight_per_length<span class="token punctuation">(</span>nominal_dia_m<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">,</span> schedule<span class="token operator">=</span>schedule<span class="token punctuation">)</span> <span class="token operator">*</span> length_m
weight_increase <span class="token operator">=</span> weight_250a <span class="token operator">-</span> weight_200a
price_increase <span class="token operator">=</span> price_nok_per_kg <span class="token operator">*</span> weight_increase
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Weight will increase by </span><span class="token interpolation"><span class="token punctuation">{</span>weight_increase<span class="token punctuation">:</span><span class="token format-spec">.1f</span><span class="token punctuation">}</span></span><span class="token string">kg&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Price due to weight will increase by </span><span class="token interpolation"><span class="token punctuation">{</span>price_increase<span class="token punctuation">:</span><span class="token format-spec">.1f</span><span class="token punctuation">}</span></span><span class="token string">NOK&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>Weight will increase by 3394.7kg
Price due to weight will increase by 67894.1NOK
</code></pre></div><h2 id="_4-net-suction-positive-head-npsh-for-pump"><a href="#_4-net-suction-positive-head-npsh-for-pump" class="header-anchor">#</a> 4. Net Suction Positive Head (NPSH) for pump</h2> <p>Given the following NPSH curve for the pump, what should be the maximum depth of water for which the pump can run without possibility for cavitation?</p> <table><thead><tr><th style="text-align:right;">Flow [m3/h]</th> <th style="text-align:right;">NPSH_r [m]</th></tr></thead> <tbody><tr><td style="text-align:right;">700</td> <td style="text-align:right;">1.00</td></tr> <tr><td style="text-align:right;">750</td> <td style="text-align:right;">1.00</td></tr> <tr><td style="text-align:right;">875</td> <td style="text-align:right;">1.00</td></tr> <tr><td style="text-align:right;">1000</td> <td style="text-align:right;">1.00</td></tr> <tr><td style="text-align:right;">1125</td> <td style="text-align:right;">1.06</td></tr> <tr><td style="text-align:right;">1250</td> <td style="text-align:right;">1.20</td></tr> <tr><td style="text-align:right;">1375</td> <td style="text-align:right;">1.40</td></tr> <tr><td style="text-align:right;">1500</td> <td style="text-align:right;">1.64</td></tr> <tr><td style="text-align:right;">1625</td> <td style="text-align:right;">2.06</td></tr> <tr><td style="text-align:right;">1750</td> <td style="text-align:right;">2.82</td></tr> <tr><td style="text-align:right;">1875</td> <td style="text-align:right;">4.00</td></tr> <tr><td style="text-align:right;">2000</td> <td style="text-align:right;">5.60</td></tr> <tr><td style="text-align:right;">2100</td> <td style="text-align:right;">7.00</td></tr></tbody></table> <p style="text-align:center;"><img src="/TMR4222_2023S/assets/img/03_Centrifugal_Pump_Performance_NPSH.f089eae1.jpg" alt="Pumping system" width="600"></p> <ul><li>\(h_p\) = 2m</li> <li>Outlet of the pump is connected to the piping system as described in Example 3 with nominal diameter of 250A.</li> <li>Outlet of the piping system has back pressure of 2 bar g</li> <li>Inlet of the pump is connected with 5m pipe of 250A stainless steel pipe with schedule 40s. The k value of the fitting is 1.5.</li></ul> <p>========================= Answer ==============================</p> <p>The volume flow of the pump will vary with inlet condition of the pump. When the depth of water is high, the pump head may be lower
as the suction head is higher than the atmospheric pressure. We will make a function that calculates the volume flow from the given
depth of water.</p> <div class="language-python extra-class"><pre class="language-python"><code>nom_dia_m <span class="token operator">=</span> <span class="token number">0.25</span>
pump_height_m <span class="token operator">=</span> <span class="token number">2</span>
_<span class="token punctuation">,</span> inner_dia_m<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _ <span class="token operator">=</span> nearest_pipe<span class="token punctuation">(</span>Di<span class="token operator">=</span>nom_dia_m<span class="token punctuation">,</span> schedule<span class="token operator">=</span>schedule<span class="token punctuation">)</span>
k_fitting_suction <span class="token operator">=</span> <span class="token number">1.5</span>
pipe_section_area_m2 <span class="token operator">=</span> inner_dia_m<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>pi <span class="token operator">/</span> <span class="token number">4</span>
length_suction_m <span class="token operator">=</span> <span class="token number">5</span>
vapor_pressure_pa <span class="token operator">=</span> fluid<span class="token punctuation">.</span>bubble_point_at_temperature<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pressure
rho_g <span class="token operator">=</span> fluid<span class="token punctuation">.</span>density <span class="token operator">*</span> gravitational_acc_m2_per_s
head_outlet <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2e5</span> <span class="token operator">+</span> <span class="token number">1e5</span><span class="token punctuation">)</span> <span class="token operator">/</span> rho_g
vol_flow_array_for_npsh_r_m3_per_h <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token number">700</span><span class="token punctuation">,</span> <span class="token number">750</span><span class="token punctuation">,</span> <span class="token number">875</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">1125</span><span class="token punctuation">,</span> <span class="token number">1250</span><span class="token punctuation">,</span> <span class="token number">1375</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">,</span> <span class="token number">1625</span><span class="token punctuation">,</span> <span class="token number">1750</span><span class="token punctuation">,</span> <span class="token number">1875</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">2100</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
npsh_r_array_m <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.06</span><span class="token punctuation">,</span> <span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token number">1.4</span><span class="token punctuation">,</span> <span class="token number">1.64</span><span class="token punctuation">,</span> <span class="token number">2.06</span><span class="token punctuation">,</span> <span class="token number">2.82</span><span class="token punctuation">,</span> <span class="token number">4.0</span><span class="token punctuation">,</span> <span class="token number">5.6</span><span class="token punctuation">,</span> <span class="token number">7.0</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
interpolate_function_for_npsh_r <span class="token operator">=</span> interp1d<span class="token punctuation">(</span>x<span class="token operator">=</span>vol_flow_array_for_npsh_r_m3_per_h<span class="token punctuation">,</span> y<span class="token operator">=</span>npsh_r_array_m<span class="token punctuation">)</span>

fig <span class="token operator">=</span> make_subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>vol_flow_array_for_npsh_r_m3_per_h<span class="token punctuation">,</span> y<span class="token operator">=</span>npsh_r_array_m<span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span>renderer<span class="token operator">=</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/TMR4222_2023S/assets/img/03_Centrifugal_Pump_Performance_26_0.ee0b4fe1.svg" alt="svg"></p> <div class="language-python extra-class"><pre class="language-python"><code>
<span class="token comment"># First, we will define a function that calculates the suction head and NPSH available</span>
<span class="token keyword">def</span> <span class="token function">get_suction_head</span><span class="token punctuation">(</span>water_depth_m<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">,</span> vol_flow_m3_per_s<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
    pressure_tank <span class="token operator">=</span> <span class="token number">1e5</span>
    velocity_m_per_s <span class="token operator">=</span> vol_flow_m3_per_s <span class="token operator">/</span> pipe_section_area_m2
    pressure_drop_fitting <span class="token operator">=</span> core<span class="token punctuation">.</span>dP_from_K<span class="token punctuation">(</span>
        K<span class="token operator">=</span>k_fitting_suction<span class="token punctuation">,</span> rho<span class="token operator">=</span>fluid<span class="token punctuation">.</span>density<span class="token punctuation">,</span> V<span class="token operator">=</span>velocity_m_per_s
    <span class="token punctuation">)</span>
    pressure_drop_pipe <span class="token operator">=</span> friction<span class="token punctuation">.</span>one_phase_dP<span class="token punctuation">(</span>
        m<span class="token operator">=</span>vol_flow_m3_per_s <span class="token operator">*</span> fluid<span class="token punctuation">.</span>density<span class="token punctuation">,</span>
        rho<span class="token operator">=</span>fluid<span class="token punctuation">.</span>density<span class="token punctuation">,</span>
        mu<span class="token operator">=</span>fluid<span class="token punctuation">.</span>dynamic_viscosity<span class="token punctuation">,</span>
        D<span class="token operator">=</span>inner_dia_m<span class="token punctuation">,</span>
        roughness<span class="token operator">=</span>roughness<span class="token punctuation">,</span>
        L<span class="token operator">=</span>length_suction_m<span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    head_loss <span class="token operator">=</span> <span class="token punctuation">(</span>pressure_drop_pipe <span class="token operator">+</span> pressure_drop_fitting<span class="token punctuation">)</span> <span class="token operator">/</span> rho_g
    <span class="token keyword">return</span> pressure_tank <span class="token operator">/</span> rho_g <span class="token operator">+</span> water_depth_m <span class="token operator">-</span> pump_height_m <span class="token operator">-</span> head_loss

<span class="token keyword">def</span> <span class="token function">get_npsh_available</span><span class="token punctuation">(</span>water_depth_m<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">,</span> vol_flow_m3_per_s<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> get_suction_head<span class="token punctuation">(</span>water_depth_m<span class="token operator">=</span>water_depth_m<span class="token punctuation">,</span> vol_flow_m3_per_s<span class="token operator">=</span>vol_flow_m3_per_s<span class="token punctuation">)</span> \
           <span class="token operator">-</span> vapor_pressure_pa <span class="token operator">/</span> rho_g

<span class="token comment"># Define function to calculate pump flow for given discharge head</span>
interpolate_vol_flow_from_head <span class="token operator">=</span> interp1d<span class="token punctuation">(</span>
    x<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Head [m]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Flow [m3/h]&quot;</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">3600</span><span class="token punctuation">,</span> kind<span class="token operator">=</span><span class="token string">&quot;cubic&quot;</span><span class="token punctuation">,</span> fill_value<span class="token operator">=</span><span class="token string">&quot;extrapolate&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_pump_vol_flow_m3_per_s</span><span class="token punctuation">(</span>discharge_head_m<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">,</span> water_depth_m<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">function_to_solve</span><span class="token punctuation">(</span>vol_flow_m3_per_s<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
        differential_head <span class="token operator">=</span> discharge_head_m <span class="token operator">-</span> get_suction_head<span class="token punctuation">(</span>
            water_depth_m<span class="token operator">=</span>water_depth_m<span class="token punctuation">,</span>
            vol_flow_m3_per_s<span class="token operator">=</span>vol_flow_m3_per_s
        <span class="token punctuation">)</span>
        <span class="token keyword">return</span> vol_flow_m3_per_s <span class="token operator">-</span> get_flow_pump_m3_per_s<span class="token punctuation">(</span>head_m<span class="token operator">=</span>differential_head<span class="token punctuation">)</span>
    initial_value <span class="token operator">=</span> interpolate_vol_flow_from_head<span class="token punctuation">(</span>discharge_head_m <span class="token operator">-</span> water_depth_m <span class="token operator">+</span> pump_height_m<span class="token punctuation">)</span>
    sol <span class="token operator">=</span> root_scalar<span class="token punctuation">(</span>f<span class="token operator">=</span>function_to_solve<span class="token punctuation">,</span> x0<span class="token operator">=</span>initial_value<span class="token punctuation">,</span> x1<span class="token operator">=</span>initial_value<span class="token operator">*</span><span class="token number">1.05</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> sol<span class="token punctuation">.</span>converged<span class="token punctuation">:</span>
        <span class="token keyword">return</span> sol<span class="token punctuation">.</span>root
    <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The solution didn't converger for </span><span class="token interpolation"><span class="token punctuation">{</span>discharge_head_m<span class="token punctuation">}</span></span><span class="token string">m head and water depth </span><span class="token interpolation"><span class="token punctuation">{</span>water_depth_m<span class="token punctuation">}</span></span><span class="token string">m&quot;</span></span><span class="token punctuation">)</span>

<span class="token comment"># Define function to calculate the flow in the system depending on the water depth</span>
<span class="token keyword">def</span> <span class="token function">get_system_vol_flow_m3_per_s</span><span class="token punctuation">(</span>water_depth_m<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">function_to_solve</span><span class="token punctuation">(</span>vol_flow_m3_per_s<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
        head_loss_output_m <span class="token operator">=</span> get_head_loss_with_flow_input<span class="token punctuation">(</span>
            flow_m3_per_s<span class="token operator">=</span>vol_flow_m3_per_s<span class="token punctuation">,</span> nom_dia_m<span class="token operator">=</span>nom_dia_m
        <span class="token punctuation">)</span>
        discharge_head_pump_m <span class="token operator">=</span> head_loss_output_m <span class="token operator">+</span> head_outlet
        <span class="token comment"># pump_vol_flow_m3_per_s = get_flow_pump_m3_per_s(discharge_head_pump_m)</span>
        pump_vol_flow_m3_per_s <span class="token operator">=</span> get_pump_vol_flow_m3_per_s<span class="token punctuation">(</span>
            discharge_head_m<span class="token operator">=</span>discharge_head_pump_m<span class="token punctuation">,</span>
            water_depth_m<span class="token operator">=</span>water_depth_m
        <span class="token punctuation">)</span>
        <span class="token keyword">return</span> vol_flow_m3_per_s <span class="token operator">-</span> pump_vol_flow_m3_per_s
    initial_value <span class="token operator">=</span> <span class="token number">1600</span> <span class="token operator">/</span> <span class="token number">3600</span>
    sol <span class="token operator">=</span> root_scalar<span class="token punctuation">(</span>f<span class="token operator">=</span>function_to_solve<span class="token punctuation">,</span> x0<span class="token operator">=</span>initial_value<span class="token punctuation">,</span> x1<span class="token operator">=</span>initial_value<span class="token operator">*</span><span class="token number">1.05</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> sol<span class="token punctuation">.</span>converged<span class="token punctuation">:</span>
        <span class="token keyword">return</span> sol<span class="token punctuation">.</span>root
    <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The solution didn't converge for </span><span class="token interpolation"><span class="token punctuation">{</span>water_depth_m<span class="token punctuation">}</span></span><span class="token string">m&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>water_depth_array_m <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span>
vol_flow_array_m3_per_s <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
    get_system_vol_flow_m3_per_s<span class="token punctuation">(</span>each_depth<span class="token punctuation">)</span> <span class="token keyword">for</span> each_depth <span class="token keyword">in</span> water_depth_array_m
<span class="token punctuation">]</span><span class="token punctuation">)</span>
npsh_available <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
    get_suction_head<span class="token punctuation">(</span>water_depth_m<span class="token operator">=</span>each_depth<span class="token punctuation">,</span> vol_flow_m3_per_s<span class="token operator">=</span>each_flow<span class="token punctuation">)</span>
    <span class="token keyword">for</span> each_depth<span class="token punctuation">,</span> each_flow <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>water_depth_array_m<span class="token punctuation">,</span> vol_flow_array_m3_per_s<span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
npsh_required <span class="token operator">=</span> interpolate_function_for_npsh_r<span class="token punctuation">(</span>vol_flow_array_m3_per_s <span class="token operator">*</span> <span class="token number">3600</span><span class="token punctuation">)</span>
fig <span class="token operator">=</span> make_subplots<span class="token punctuation">(</span>cols<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> rows<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>water_depth_array_m<span class="token punctuation">,</span> y<span class="token operator">=</span>vol_flow_array_m3_per_s <span class="token operator">*</span> <span class="token number">3600</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Vol flow [m3/h]&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>water_depth_array_m<span class="token punctuation">,</span> y<span class="token operator">=</span>npsh_available<span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;NPSH available [m]&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>water_depth_array_m<span class="token punctuation">,</span> y<span class="token operator">=</span>npsh_required<span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;NPSH required [m]&quot;</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>update_layout<span class="token punctuation">(</span>height<span class="token operator">=</span><span class="token number">800</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">800</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span>renderer<span class="token operator">=</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/TMR4222_2023S/assets/img/03_Centrifugal_Pump_Performance_28_0.b816f717.svg" alt="svg"></p> <h3 id="what-will-be-the-method-to-lower-this-limit-to-ensure-to-pump-out-most-of-the-water-in-the-tank"><a href="#what-will-be-the-method-to-lower-this-limit-to-ensure-to-pump-out-most-of-the-water-in-the-tank" class="header-anchor">#</a> What will be the method to lower this limit to ensure to pump out most of the water in the tank?</h3> <p>================= Answer =====================
Reducing the flow by throttling the pump will enable the pump to lower the required NPSH.
This can be simulated by increasing the K value of the outlet.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_system_vol_flow_m3_per_s</span><span class="token punctuation">(</span>
        water_depth_m<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">,</span>
        additional_k_valve<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">,</span>
        initial_value_m3_per_h<span class="token punctuation">:</span> <span class="token builtin">float</span>
<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">function_to_solve</span><span class="token punctuation">(</span>vol_flow_m3_per_s<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
        head_loss_output_m <span class="token operator">=</span> get_head_loss_with_flow_input<span class="token punctuation">(</span>
            flow_m3_per_s<span class="token operator">=</span>vol_flow_m3_per_s<span class="token punctuation">,</span> nom_dia_m<span class="token operator">=</span>nom_dia_m
        <span class="token punctuation">)</span>
        velocity <span class="token operator">=</span> vol_flow_m3_per_s <span class="token operator">/</span> pipe_section_area_m2
        additional_head_loss_valve_m <span class="token operator">=</span> core<span class="token punctuation">.</span>head_from_K<span class="token punctuation">(</span>
            K<span class="token operator">=</span>additional_k_valve<span class="token punctuation">,</span> V<span class="token operator">=</span>velocity<span class="token punctuation">,</span> g<span class="token operator">=</span>gravitational_acc_m2_per_s
        <span class="token punctuation">)</span>
        discharge_head_pump_m <span class="token operator">=</span> head_loss_output_m <span class="token operator">+</span> head_outlet <span class="token operator">+</span> additional_head_loss_valve_m
        <span class="token comment"># pump_vol_flow_m3_per_s = get_flow_pump_m3_per_s(discharge_head_pump_m)</span>
        pump_vol_flow_m3_per_s <span class="token operator">=</span> get_pump_vol_flow_m3_per_s<span class="token punctuation">(</span>
            discharge_head_m<span class="token operator">=</span>discharge_head_pump_m<span class="token punctuation">,</span>
            water_depth_m<span class="token operator">=</span>water_depth_m
        <span class="token punctuation">)</span>
        <span class="token keyword">return</span> vol_flow_m3_per_s <span class="token operator">-</span> pump_vol_flow_m3_per_s
    initial_value <span class="token operator">=</span> initial_value_m3_per_h <span class="token operator">/</span> <span class="token number">3600</span>
    sol <span class="token operator">=</span> root_scalar<span class="token punctuation">(</span>f<span class="token operator">=</span>function_to_solve<span class="token punctuation">,</span> x0<span class="token operator">=</span>initial_value<span class="token punctuation">,</span> x1<span class="token operator">=</span>initial_value<span class="token operator">*</span><span class="token number">1.05</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> sol<span class="token punctuation">.</span>converged<span class="token punctuation">:</span>
        <span class="token keyword">return</span> sol<span class="token punctuation">.</span>root
    <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The solution didn't converge for </span><span class="token interpolation"><span class="token punctuation">{</span>water_depth_m<span class="token punctuation">}</span></span><span class="token string">m&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>k_values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span>
initial_values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1500</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">]</span>

fig <span class="token operator">=</span> make_subplots<span class="token punctuation">(</span>cols<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> rows<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> k_valve<span class="token punctuation">,</span> initial_value <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>k_values<span class="token punctuation">,</span> initial_values<span class="token punctuation">)</span><span class="token punctuation">:</span>
    water_depth_array_m <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>
    vol_flow_array_m3_per_s <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
        get_system_vol_flow_m3_per_s<span class="token punctuation">(</span>
            water_depth_m<span class="token operator">=</span>each_depth<span class="token punctuation">,</span>
            additional_k_valve<span class="token operator">=</span>k_valve<span class="token punctuation">,</span>
            initial_value_m3_per_h<span class="token operator">=</span>initial_value
        <span class="token punctuation">)</span> <span class="token keyword">for</span> each_depth <span class="token keyword">in</span> water_depth_array_m
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
    npsh_available <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
        get_suction_head<span class="token punctuation">(</span>water_depth_m<span class="token operator">=</span>each_depth<span class="token punctuation">,</span> vol_flow_m3_per_s<span class="token operator">=</span>each_flow<span class="token punctuation">)</span>
        <span class="token keyword">for</span> each_depth<span class="token punctuation">,</span> each_flow <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>water_depth_array_m<span class="token punctuation">,</span> vol_flow_array_m3_per_s<span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
    npsh_required <span class="token operator">=</span> interpolate_function_for_npsh_r<span class="token punctuation">(</span>vol_flow_array_m3_per_s <span class="token operator">*</span> <span class="token number">3600</span><span class="token punctuation">)</span>
    fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>water_depth_array_m<span class="token punctuation">,</span> y<span class="token operator">=</span>vol_flow_array_m3_per_s <span class="token operator">*</span> <span class="token number">3600</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;Vol flow - k </span><span class="token interpolation"><span class="token punctuation">{</span>k_valve<span class="token punctuation">}</span></span><span class="token string"> [m3/h]&quot;</span></span><span class="token punctuation">)</span>
    fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>water_depth_array_m<span class="token punctuation">,</span> y<span class="token operator">=</span>npsh_available<span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;NPSH available - k </span><span class="token interpolation"><span class="token punctuation">{</span>k_valve<span class="token punctuation">}</span></span><span class="token string"> [m]&quot;</span></span><span class="token punctuation">)</span>
    fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>water_depth_array_m<span class="token punctuation">,</span> y<span class="token operator">=</span>npsh_required<span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;NPSH required - k </span><span class="token interpolation"><span class="token punctuation">{</span>k_valve<span class="token punctuation">}</span></span><span class="token string">  [m]&quot;</span></span><span class="token punctuation">)</span>
    fig<span class="token punctuation">.</span>update_layout<span class="token punctuation">(</span>height<span class="token operator">=</span><span class="token number">800</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">800</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span>renderer<span class="token operator">=</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/TMR4222_2023S/assets/img/03_Centrifugal_Pump_Performance_31_0.284fec74.svg" alt="svg"></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/TMR4222_2023S/pipe-network-analysis/" class="prev">
        Pipe Network Analysis
      </a></span> <span class="next"><a href="/TMR4222_2023S/pump-control/">
        Pump Control
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/TMR4222_2023S/assets/js/app.4abb8553.js" defer></script><script src="/TMR4222_2023S/assets/js/2.2891b1df.js" defer></script><script src="/TMR4222_2023S/assets/js/3.2051a86c.js" defer></script>
  </body>
</html>
